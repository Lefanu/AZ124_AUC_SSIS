<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/8/2010 10:19:43 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="PAIOLETTI"
  DTS:CreatorName="PAIOLETTI\i.paioletti"
  DTS:DelayValidation="True"
  DTS:Description="Migrazione Lavoratori Domestici"
  DTS:DTSID="{4E27432B-6541-4BA4-89E8-E576FF008760}"
  DTS:EnableConfig="True"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.123"
  DTS:LocaleID="1040"
  DTS:MaxErrorCount="0"
  DTS:ObjectName="AZ124_SIN_SSIS_035"
  DTS:ProtectionLevel="2"
  DTS:VersionBuild="1576"
  DTS:VersionGUID="{ECE54509-843B-47C5-A34B-E070C767D1C4}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="LogConnection"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{25728997-1ECA-44AE-AB3D-525158C7E0B3}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{38BFD5D2-22D6-4E6C-83E6-048B8360F414}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="K_LOG_ENABLED">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{997B3B32-62B6-4FC7-A35B-CAB5B1928C8E}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="sDataStart">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DDB6A67F-6911-43F8-AA4A-22122E3633BF}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="sIntervalloStandard">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B734A02D-0752-41B0-8BAE-CFA294AB6EDB}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="vChiave">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">2,7,OnError,12,OnTaskFailed</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnTaskFailed"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnWarning"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{25728997-1ECA-44AE-AB3D-525158C7E0B3}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:PropertyExpression
    DTS:Name="LoggingMode">@[User::K_LOG_ENABLED]</DTS:PropertyExpression>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\00_TI_ANTOG"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="00_TI_ANTOG"
      DTS:DTSID="{33327f29-e9b8-45ef-9d77-1dc4120dc728}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="00_TI_ANTOG"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--USE [AUC]&#xA;--GO&#xA;&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTOG_TOPERPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_antog (id_antog int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_antog (id_antog, id_auc) &#xA;&#x9;   SELECT&#x9;ANTOG_COD_TOPERPG_PK, max(ANTOG_AUC_CODICE_PK) FROM TB_ANTOG_TOPERPG_CT&#xA;&#x9;   WHERE&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANTOG_COD_TOPERPG_PK&#xA;&#x9;--select * from #temp_antog&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANTOG_TOPERPG_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;ANTOG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANTOG_TOPERPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_antog ON &#xA;&#x9;&#x9;&#x9;&#x9;ANTOG_AUC_CODICE_PK &lt;&gt; #temp_antog.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_antog = ANTOG_COD_TOPERPG_PK&#xA;&#x9;&#x9;WHERE&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_antog&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTOG_TOPERPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTOG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANTOG_TOPERPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTOG_TOPERPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK = TI_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK &#xA;&#x9;WHERE&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANTOG_COD_TOPERPG_PK], [ANTOG_AUC_STATO_LAVORAZIONE] = 1 e [ANTOG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANTOG_TOPERPG_CT&#xA;   SET&#x9;&#x9;TI_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DESCR_TOPERPG&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_DESCR_TOPERPG&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_INIZ&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_DATA_INIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_FINE&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_FLAG_ESPOSIZ&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_FLAG_ESPOSIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_NUM_ORDINAM&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_NUM_ORDINAM&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_COD_UTENTE&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_AGGIORN&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_COD_APPL&#x9;&#x9;&#x9;=&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_MODIFICA&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANTOG_TOPERPG_CT.ANTOG_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANTOG_TOPERPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTOG_TOPERPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK = TI_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANTOG_COD_TOPERPG_PK], [ANTOG_AUC_STATO_LAVORAZIONE] = 1 e [ANTOG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANTOG_TOPERPG_CT&#xA;           (TI_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DESCR_TOPERPG&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_INIZ&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_FINE&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_FLAG_ESPOSIZ&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_NUM_ORDINAM&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_COD_UTENTE&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_AGGIORN&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_COD_APPL&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DATA_MODIFICA&#xA;           ,TI_ANTOG_TOPERPG_CT.ANTOG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_DESCR_TOPERPG&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_DATA_INIZ&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_FLAG_ESPOSIZ&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_NUM_ORDINAM&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANTOG_TOPERPG_CT.ANTOG_COD_APPL&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANTOG_TOPERPG_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANTOG_TOPERPG_CT ON &#xA;--&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK &lt;&gt; TI_ANTOG_TOPERPG_CT.ANTOG_COD_TOPERPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTOG_TOPERPG_CT.ANTOG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANTOG_TOPERPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\01_TI_BDRG"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="01_TI_BDRG"
      DTS:DTSID="{639e86c3-27d4-42d2-a7ea-46892116a237}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="01_TI_BDRG"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9; BDRG_RGNATGIU_CT&#xA;&#x9;SET&#x9;&#x9;BDRG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDRG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdrg (id_bdrg int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdrg (id_bdrg, id_auc) &#xA;&#x9;   SELECT&#x9;BDRG_ID_VA, max(BDRG_AUC_CODICE_PK) FROM  BDRG_RGNATGIU_CT&#xA;&#x9;   WHERE&#x9;BDRG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDRG_ID_VA&#xA;&#x9;--select * from #temp_BDRG&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9; BDRG_RGNATGIU_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;BDRG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDRG_RGNATGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdrg ON &#xA;&#x9;&#x9;&#x9;&#x9;BDRG_AUC_CODICE_PK &lt;&gt; #temp_bdrg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdrg = BDRG_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDRG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdrg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9; BDRG_RGNATGIU_CT&#xA;&#x9;SET&#x9;&#x9;BDRG_AUC_PRESENTE = 1&#xA;&#x9;FROM     BDRG_RGNATGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDRG_RGNATGIU_CT ON &#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_ID_VA = TI_BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;&#x9;WHERE&#x9; BDRG_RGNATGIU_CT.BDRG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDRG_ID_VA], [BDRG_AUC_STATO_LAVORAZIONE] = 1 e [BDRG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDRG_RGNATGIU_CT&#xA;   SET&#x9;&#x9;TI_BDRG_RGNATGIU_CT.BDRG_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_CODICE_VB&#x9;&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_CODICE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_DESCRIZ_VB&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_NSI_VB&#x9;&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_NSI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_DATAINI_VB&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_DATAFIN_VB&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_BDTS_ERI_VR&#x9;&#x9;=&#x9;BDRG_RGNATGIU_CT.BDRG_BDTS_ERI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDRG_RGNATGIU_CT.BDRG_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM     BDRG_RGNATGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDRG_RGNATGIU_CT ON &#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_ID_VA = TI_BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDRG_ID_VA], [BDRG_AUC_STATO_LAVORAZIONE] = 1 e [BDRG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDRG_RGNATGIU_CT&#xA;           (TI_BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_CODICE_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_DESCRIZ_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_MODREC_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_NSI_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_DATAINI_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_DATAFIN_VB&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_BDTS_ERI_VR&#xA;&#x9;&#x9;   ,TI_BDRG_RGNATGIU_CT.BDRG_DATA_MODIFICA&#xA;           ,TI_BDRG_RGNATGIU_CT.BDRG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_CODICE_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_DESCRIZ_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_MODREC_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_NSI_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_DATAINI_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_DATAFIN_VB&#xA;&#x9;&#x9;  ,BDRG_RGNATGIU_CT.BDRG_BDTS_ERI_VR&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM     BDRG_RGNATGIU_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDRG_RGNATGIU_CT ON &#xA;--&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_ID_VA &lt;&gt; TI_BDRG_RGNATGIU_CT.BDRG_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9; BDRG_RGNATGIU_CT.BDRG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9; BDRG_RGNATGIU_CT&#xA;&#x9;SET&#x9;&#x9;BDRG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDRG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\02_TB_AUCAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="02_TB_AUCAS"
      DTS:DTSID="{c88d40da-4c3a-4aa4-ac8c-06279dba5077}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="02_TB_AUCAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;[BDCS_CASSA_CL]&#xA;&#x9;SET&#x9;&#x9;BDCS_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDCS_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdcs (id_bdcs int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdcs (id_bdCs, id_auc) &#xA;&#x9;   SELECT&#x9;[BDCS_ID_VA], max(BDCS_AUC_CODICE_PK) FROM [BDCS_CASSA_CL]&#xA;&#x9;   WHERE&#x9;BDCS_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;[BDCS_ID_VA]&#xA;&#x9;--select * from #temp_antlp&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;[BDCS_CASSA_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;BDCS_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;[BDCS_CASSA_CL]&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdcs ON &#xA;&#x9;&#x9;&#x9;&#x9;BDCS_AUC_CODICE_PK &lt;&gt; #temp_bdcs.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdcs = [BDCS_ID_VA]&#xA;&#x9;&#x9;WHERE&#x9;bdcs_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdcs&#xA;&#xA;-- SOlo la prima volta in caso di caricamento&#xA;--update tb_aucas_casse_inpdap&#xA;--set [AUCAS_BDCS_ID_VA] = [BDCS_ID_VA]&#xA;--from tb_aucas_casse_inpdap inner join [BDCS_CASSA_CL] on BDCS_CODICE_VB = aucas_codice&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;[BDCS_CASSA_CL]&#xA;&#x9;SET&#x9;&#x9;BDCS_AUC_PRESENTE = 1&#xA;&#x9;FROM    [BDCS_CASSA_CL]&#x9;&#x9;INNER JOIN&#x9;&#x9;TB_AUCAS_CASSE_INPDAP ON &#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].[BDCS_ID_VA] = TB_AUCAS_CASSE_INPDAP.[AUCAS_BDCS_ID_VA] &#xA;&#x9;WHERE&#x9;[BDCS_CASSA_CL].BDCS_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDCS_ID_VA], [BDCS_AUC_STATO_LAVORAZIONE] = 1 e [BDCS_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TB_AUCAS_CASSE_INPDAP&#xA;  SET [aucas_codice] = BDCS_CODICE_VB,&#xA;      [aucas_descrizione_brevre] = [BDCS_DESCRABB_VB],&#xA;      [aucas_descrizione] = [BDCS_DESCRIZ_VB],&#xA;      [aucas_data_modifica] = GetDate(),&#xA;      [aucas_descr_utente] = 'Variazione pubblici',&#xA;      [AUCAS_BDCS_ID_VA] = BDCS_ID_VA, &#xA;      [AUCAS_BDCS_CODFIN_VB] = BDCS_CODFIN_VB, &#xA;      [AUCAS_BDCS_CODFISC_VB] = BDCS_CODFISC_VB, &#xA;      [AUCAS_BDCS_FLGPEPR_VB] = BDCS_FLGPEPR_VB, &#xA;      [AUCAS_BDCS_NUMERO_VB] = BDCS_NUMERO_VB, &#xA;      [AUCAS_BDCS_SIGLA_VB] = BDCS_SIGLA_VB, &#xA;      [AUCAS_BDCS_MODREC_VB] = BDCS_MODREC_VB, &#xA;      [AUCAS_BDCS_CODEN_VB] = BDCS_CODEN_VB, &#xA;      [AUCAS_BDCS_DATAINI_VB] = BDCS_DATAINI_VB, &#xA;      [AUCAS_BDCS_DATAFIN_VB] = BDCS_DATAFIN_VB, &#xA;      [AUCAS_BDCS_NSI_VB] = BDCS_NSI_VB&#xA;&#x9;FROM    [BDCS_CASSA_CL]&#x9;&#x9;INNER JOIN&#x9;&#x9;TB_AUCAS_CASSE_INPDAP ON &#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].[BDCS_ID_VA] = TB_AUCAS_CASSE_INPDAP.[AUCAS_BDCS_ID_VA] &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].BDCS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].BDCS_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDCS_ID_VA], BDCS_AUC_STATO_LAVORAZIONE] = 1 e [BDCS_AUC_PRESENTE] = 0 &#xA;INSERT INTO TB_AUCAS_CASSE_INPDAP&#xA;           (&#xA;&#x9;&#x9;&#x9;[aucas_codice] ,&#xA;&#x9;&#x9;    [aucas_descrizione_brevre] ,&#xA;&#x9;&#x9;&#x9;[aucas_descrizione] ,&#xA;&#x9;&#x9;&#x9;[aucas_data_modifica] ,&#xA;&#x9;&#x9;&#x9;[aucas_descr_utente] ,&#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_ID_VA] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_CODFIN_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_CODFISC_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_FLGPEPR_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_NUMERO_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_SIGLA_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_MODREC_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_CODEN_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_DATAINI_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_DATAFIN_VB] , &#xA;&#x9;&#x9;&#x9;[AUCAS_BDCS_NSI_VB] &#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;BDCS_CODICE_VB,&#xA;&#x9;&#x9;[BDCS_DESCRABB_VB],&#xA;&#x9;&#x9;[BDCS_DESCRIZ_VB],&#xA;&#x9;&#x9;GetDate(),&#xA;&#x9;&#x9;'Variazione pubblici',&#xA;&#x9;&#x9;BDCS_ID_VA, &#xA;&#x9;&#x9;BDCS_CODFIN_VB, &#xA;&#x9;&#x9;BDCS_CODFISC_VB, &#xA;&#x9;&#x9;BDCS_FLGPEPR_VB, &#xA;&#x9;&#x9;BDCS_NUMERO_VB, &#xA;&#x9;&#x9;BDCS_SIGLA_VB, &#xA;&#x9;&#x9;BDCS_MODREC_VB, &#xA;&#x9;&#x9;BDCS_CODEN_VB, &#xA;&#x9;&#x9;BDCS_DATAINI_VB, &#xA;&#x9;&#x9;BDCS_DATAFIN_VB, &#xA;&#x9;&#x9;BDCS_NSI_VB&#xA;&#x9;FROM    [BDCS_CASSA_CL]&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TB_AUCAS_CASSE_INPDAP ON &#xA;&#x9;&#x9;&#x9;--[BDCS_CASSA_CL].[BDCS_ID_VA] &lt;&gt; TB_AUCAS_CASSE_INPDAP.[AUCAS_BDCS_ID_VA] &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].BDCS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;[BDCS_CASSA_CL].BDCS_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;[BDCS_CASSA_CL]&#xA;&#x9;SET&#x9;&#x9;BDCS_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDCS_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\03_TI_ANTRL"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="03_TI_ANTRL"
      DTS:DTSID="{ed436b54-8020-4b87-b7eb-809c6d3b9ec5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="03_TI_ANTRL"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_antrl (id_antrl int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_antrl (id_antrl, id_auc) &#xA;&#x9;   SELECT&#x9;ANTRL_COD_TIPRUOLOPG_PK, max(ANTRL_AUC_CODICE_PK) FROM TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;   WHERE&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;--select * from #temp_antrl&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;ANTRL_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANTRL_TIPRUOLOPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_antrl ON &#xA;&#x9;&#x9;&#x9;&#x9;ANTRL_AUC_CODICE_PK &lt;&gt; #temp_antrl.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_antrl = ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;&#x9;WHERE&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_antrl&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTRL_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANTRL_TIPRUOLOPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTRL_TIPRUOLOPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK = TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK &#xA;&#x9;WHERE&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANTRL_COD_TIPRUOLOPG_PK], [ANTRL_AUC_STATO_LAVORAZIONE] = 1 e [ANTRL_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANTRL_TIPRUOLOPG_CT&#xA;   SET&#x9;&#x9;TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_TIPRUOLOPG&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_TIPRUOLOPG&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_INIZ&#x9;&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_INIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_FINE&#x9;&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_DCUTENTE&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_DCUTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_ESPOSIZ&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_ESPOSIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_UTENTE&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_AGGIORN&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_APPL&#x9;&#x9;&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_SEDEUTENTE&#x9;=&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_SEDEUTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANTRL_TIPRUOLOPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTRL_TIPRUOLOPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK = TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANTRL_COD_TIPRUOLOPG_PK], [ANTRL_AUC_STATO_LAVORAZIONE] = 1 e [ANTRL_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANTRL_TIPRUOLOPG_CT&#xA;           (TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_TIPRUOLOPG&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_INIZ&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_FINE&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_DCUTENTE&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_ESPOSIZ&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_UTENTE&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_AGGIORN&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_APPL&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_SEDEUTENTE&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_MODIFICA&#xA;           ,TI_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DESCR_TIPRUOLOPG&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_INIZ&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_DCUTENTE&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_ESPOSIZ&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANTRL_TIPRUOLOPG_CT.ANTRL_FLAG_SEDEUTENTE&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANTRL_TIPRUOLOPG_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANTRL_TIPRUOLOPG_CT ON &#xA;--&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK &lt;&gt; TI_ANTRL_TIPRUOLOPG_CT.ANTRL_COD_TIPRUOLOPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTRL_TIPRUOLOPG_CT.ANTRL_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\04_TI_ANTLP"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="04_TI_ANTLP"
      DTS:DTSID="{878d747b-2d32-4a7c-a375-ab19e82ad039}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="04_TI_ANTLP"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_antlp (id_antlp int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_antlp (id_antlp, id_auc) &#xA;&#x9;   SELECT&#x9;ANTLP_COD_TIPLEGAMEPG_PK, max(ANTLP_AUC_CODICE_PK) FROM TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;   WHERE&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;--select * from #temp_antlp&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;ANTLP_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_antlp ON &#xA;&#x9;&#x9;&#x9;&#x9;ANTLP_AUC_CODICE_PK &lt;&gt; #temp_antlp.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_antlp = ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;&#x9;WHERE&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_antlp&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTLP_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANTLP_TIPLEGAMEPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTLP_TIPLEGAMEPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK = TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK &#xA;&#x9;WHERE&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANTLP_COD_TIPLEGAMEPG_PK], [ANTLP_AUC_STATO_LAVORAZIONE] = 1 e [BDNG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANTLP_TIPLEGAMEPG_CT&#xA;   SET&#x9;&#x9;TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_TIPLEGAMEPG&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_TIPLEGAMEPG&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_INIZ&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_INIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_FINE&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_FLAG_ESPOSIZ&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_FLAG_ESPOSIZ&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_NOTE_TIPLEGAMEPG&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_NOTE_TIPLEGAMEPG&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_UTENTE&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_AGGIORN&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_APPL&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_UTENTE&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANTLP_TIPLEGAMEPG_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANTLP_TIPLEGAMEPG_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK = TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANTLP_COD_TIPLEGAMEPG_PK], ANTLP_AUC_STATO_LAVORAZIONE] = 1 e [ANTLP_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANTLP_TIPLEGAMEPG_CT&#xA;           (TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_TIPLEGAMEPG&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_INIZ&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_FINE&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_FLAG_ESPOSIZ&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_NOTE_TIPLEGAMEPG&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_UTENTE&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_AGGIORN&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_APPL&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_MODIFICA&#xA;           ,TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DESCR_TIPLEGAMEPG&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_INIZ&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_FLAG_ESPOSIZ&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_NOTE_TIPLEGAMEPG&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_APPL&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANTLP_TIPLEGAMEPG_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANTLP_TIPLEGAMEPG_CT ON &#xA;--&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK &lt;&gt; TI_ANTLP_TIPLEGAMEPG_CT.ANTLP_COD_TIPLEGAMEPG_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANTLP_TIPLEGAMEPG_CT.ANTLP_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\05_TI_ANFGI"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="05_TI_ANFGI"
      DTS:DTSID="{12d28895-48e5-4b96-bea8-be5c67ccc00f}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="05_TI_ANFGI"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANFGI_FORMAGIU_CT&#xA;&#x9;SET&#x9;&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anfgi (id_bdng int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anfgi (id_bdng, id_auc) &#xA;&#x9;   SELECT&#x9;ANFGI_COD_FORMAGIUR_PK, max(ANFGI_AUC_CODICE_PK) FROM TB_ANFGI_FORMAGIU_CT&#xA;&#x9;   WHERE&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANFGI_COD_FORMAGIUR_PK&#xA;&#x9;--select * from #temp_anfgi&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANFGI_FORMAGIU_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;ANFGI_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANFGI_FORMAGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anfgi ON &#xA;&#x9;&#x9;&#x9;&#x9;ANFGI_AUC_CODICE_PK &lt;&gt; #temp_anfgi.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdng = ANFGI_COD_FORMAGIUR_PK&#xA;&#x9;&#x9;WHERE&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anfgi&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANFGI_FORMAGIU_CT&#xA;&#x9;SET&#x9;&#x9;ANFGI_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANFGI_FORMAGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANFGI_FORMAGIU_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK = TI_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK &#xA;&#x9;WHERE&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANFGI_COD_FORMAGIUR_PK], [ANFGI_AUC_STATO_LAVORAZIONE] = 1 e [ANFGI_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANFGI_FORMAGIU_CT&#xA;   SET&#x9;&#x9;TI_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCL_FORMAGIUR&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_DESCL_FORMAGIUR&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCB_FORMAGIUR&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_DESCB_FORMAGIUR&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_INIZ&#x9;&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_INIZ&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_FINE&#x9;&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_FLAG_RESIDEN&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_FLAG_RESIDEN&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_FLAG_ESPOSIZ&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_FLAG_ESPOSIZ&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_NUMB_ORDINAM&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_NUMB_ORDINAM&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_COD_UTENTE&#x9;&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_AGGIORN&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_COD_APPL&#x9;&#x9;&#x9;=&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANFGI_FORMAGIU_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANFGI_FORMAGIU_CT ON &#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK = TI_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANFGI_COD_FORMAGIUR_PK], [ANFGI_AUC_STATO_LAVORAZIONE] = 1 e [ANFGI_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANFGI_FORMAGIU_CT&#xA;           (TI_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCL_FORMAGIUR&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCB_FORMAGIUR&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_INIZ&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_FINE&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_FLAG_RESIDEN&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_FLAG_ESPOSIZ&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_NUMB_ORDINAM&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_COD_UTENTE&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_AGGIORN&#xA;&#x9;&#x9;   ,TI_ANFGI_FORMAGIU_CT.ANFGI_COD_APPL&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DATA_MODIFICA&#xA;           ,TI_ANFGI_FORMAGIU_CT.ANFGI_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_DESCL_FORMAGIUR&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_DESCB_FORMAGIUR&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_INIZ&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_FLAG_RESIDEN&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_FLAG_ESPOSIZ&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_NUMB_ORDINAM&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANFGI_FORMAGIU_CT.ANFGI_COD_APPL&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANFGI_FORMAGIU_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANFGI_FORMAGIU_CT ON &#xA;--&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK &lt;&gt; TI_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANFGI_FORMAGIU_CT.ANFGI_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANFGI_FORMAGIU_CT&#xA;&#x9;SET&#x9;&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\06_TI_BDTS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="06_TI_BDTS"
      DTS:DTSID="{63767ffa-0a29-4743-9306-d21b9a7c10db}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="06_TI_BDTS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDTS_TIPOSOC_CT&#xA;&#x9;SET&#x9;&#x9;BDTS_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDTS_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdts (id_bdts int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdts (id_bdts, id_auc) &#xA;&#x9;   SELECT&#x9;BDTS_ID_VA, max(BDTS_AUC_CODICE_PK) FROM BDTS_TIPOSOC_CT&#xA;&#x9;   WHERE&#x9;BDTS_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDTS_ID_VA&#xA;&#x9;--select * from #temp_bdts&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDTS_TIPOSOC_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;BDTS_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDTS_TIPOSOC_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdts ON &#xA;&#x9;&#x9;&#x9;&#x9;BDTS_AUC_CODICE_PK &lt;&gt; #temp_bdts.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdts = BDTS_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDTS_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdts&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDTS_TIPOSOC_CT&#xA;&#x9;SET&#x9;&#x9;BDTS_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDTS_TIPOSOC_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDTS_TIPOSOC_CT ON &#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_ID_VA = TI_BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;&#x9;WHERE&#x9;BDTS_TIPOSOC_CT.BDTS_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDTS_ID_VA], [BDTS_AUC_STATO_LAVORAZIONE] = 1 e [BDTS_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDTS_TIPOSOC_CT&#xA;   SET&#x9;&#x9;TI_BDTS_TIPOSOC_CT.BDTS_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_CODICE_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_CODICE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_DESCRIZ_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_DATAINI_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_DATAFIN_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_NSI_VB&#x9;&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_NSI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_FLGDCE_VB&#x9;&#x9;&#x9;=&#x9;BDTS_TIPOSOC_CT.BDTS_FLGDCE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDTS_TIPOSOC_CT.BDTS_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    BDTS_TIPOSOC_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDTS_TIPOSOC_CT ON &#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_ID_VA = TI_BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDTS_ID_VA], [BDTS_AUC_STATO_LAVORAZIONE] = 1 e [BDTS_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDTS_TIPOSOC_CT&#xA;           (TI_BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_CODICE_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_DESCRIZ_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_MODREC_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_DATAINI_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_DATAFIN_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_NSI_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_FLGDCE_VB&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_DATA_MODIFICA&#xA;           ,TI_BDTS_TIPOSOC_CT.BDTS_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_CODICE_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_DESCRIZ_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_MODREC_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_DATAINI_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_DATAFIN_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_NSI_VB&#xA;&#x9;&#x9;  ,BDTS_TIPOSOC_CT.BDTS_FLGDCE_VB&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    BDTS_TIPOSOC_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDTS_TIPOSOC_CT ON &#xA;--&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_ID_VA &lt;&gt; TI_BDTS_TIPOSOC_CT.BDTS_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDTS_TIPOSOC_CT.BDTS_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDTS_TIPOSOC_CT&#xA;&#x9;SET&#x9;&#x9;BDTS_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDTS_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\07_TI_ANOPG"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="07_TI_ANOPG"
      DTS:DTSID="{341b7204-2669-41dc-bbff-ccec1f1c99a5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="07_TI_ANOPG"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANOPG_OPERAZPG_CL&#xA;&#x9;SET&#x9;&#x9;anopg_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;anopg_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anopg (id_anopg int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anopg (id_anopg, id_auc) &#xA;&#x9;   SELECT&#x9;ANOPG_SEQ_OPERAZPG_PK, max(anopg_AUC_CODICE_PK) FROM TB_ANOPG_OPERAZPG_CL&#xA;&#x9;   WHERE&#x9;anopg_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;--select * from #temp_anopg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANOPG_OPERAZPG_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;anopg_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANOPG_OPERAZPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anopg ON &#xA;&#x9;&#x9;&#x9;&#x9;anopg_AUC_CODICE_PK &lt;&gt; #temp_anopg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anopg = ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;&#x9;WHERE&#x9;anopg_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anopg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANOPG_OPERAZPG_CL&#xA;&#x9;SET&#x9;&#x9;anopg_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANOPG_OPERAZPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANOPG_OPERAZPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK = TI_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;WHERE&#x9;TB_ANOPG_OPERAZPG_CL.anopg_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANOPG_SEQ_OPERAZPG_PK], [anopg_AUC_STATO_LAVORAZIONE] = 1 e [anopg_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANOPG_OPERAZPG_CL&#xA;   SET&#x9;&#x9;TI_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_ANTOG_COD_TOPERPG&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_ANTOG_COD_TOPERPG&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_DECORRENZA&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_DECORRENZA&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_COD_UTENTE&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_AGGIORN&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_COD_APPL&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_SISTEMA&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.anopg_DATA_MODIFICA&#x9;&#x9;&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANOPG_OPERAZPG_CL.anopg_DESCR_UTENTE&#x9;&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANOPG_OPERAZPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANOPG_OPERAZPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK = TI_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.anopg_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.anopg_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANOPG_SEQ_OPERAZPG_PK], [anopg_AUC_STATO_LAVORAZIONE] = 1 e [anopg_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANOPG_OPERAZPG_CL&#xA;           (TI_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_ANTOG_COD_TOPERPG&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_DECORRENZA&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_COD_UTENTE&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_AGGIORN&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_COD_APPL&#xA;           ,TI_ANOPG_OPERAZPG_CL.ANOPG_DATA_SISTEMA&#xA;           ,TI_ANOPG_OPERAZPG_CL.anopg_DATA_MODIFICA&#xA;           ,TI_ANOPG_OPERAZPG_CL.anopg_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_ANTOG_COD_TOPERPG&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_DECORRENZA&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANOPG_OPERAZPG_CL.ANOPG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANOPG_OPERAZPG_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANOPG_OPERAZPG_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK &lt;&gt; TI_ANOPG_OPERAZPG_CL.ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.anopg_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANOPG_OPERAZPG_CL.anopg_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANOPG_OPERAZPG_CL&#xA;&#x9;SET&#x9;&#x9;anopg_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;anopg_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\10_TI_BDNG"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="10_TI_BDNG"
      DTS:DTSID="{6068eaa5-6df2-49ae-ace5-89a2d2ca6aa9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="10_TI_BDNG"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDNG_NATGIUR_CT&#xA;&#x9;SET&#x9;&#x9;BDNG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDNG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdng (id_bdng int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdng (id_bdng, id_auc) &#xA;&#x9;   SELECT&#x9;BDNG_ID_VA, max(BDNG_AUC_CODICE_PK) FROM BDNG_NATGIUR_CT&#xA;&#x9;   WHERE&#x9;BDNG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDNG_ID_VA&#xA;&#x9;--select * from #temp_bdng&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDNG_NATGIUR_CT&#xA;&#x9;&#x9;SET&#x9;&#x9;BDNG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDNG_NATGIUR_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdng ON &#xA;&#x9;&#x9;&#x9;&#x9;BDNG_AUC_CODICE_PK &lt;&gt; #temp_bdng.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdng = BDNG_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDNG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdng&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDNG_NATGIUR_CT&#xA;&#x9;SET&#x9;&#x9;BDNG_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDNG_NATGIUR_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDNG_NATGIUR_CT ON &#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_ID_VA = TI_BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;&#x9;WHERE&#x9;BDNG_NATGIUR_CT.BDNG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDNG_ID_VA], [BDNG_AUC_STATO_LAVORAZIONE] = 1 e [BDNG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDNG_NATGIUR_CT&#xA;   SET&#x9;&#x9;TI_BDNG_NATGIUR_CT.BDNG_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_CODICE_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_CODICE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_DESCRIZ_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_NSI_VB&#x9;&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_NSI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_BDRG_ERI_VR&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_BDRG_ERI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_DATAINI_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_DATAFIN_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_FLGOBBL_VB&#x9;&#x9;&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_FLGOBBL_VB&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_FLAG_DATABLOCPA&#x9;=&#x9;BDNG_NATGIUR_CT.BDNG_FLAG_DATABLOCPA&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDNG_NATGIUR_CT.BDNG_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    BDNG_NATGIUR_CT&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDNG_NATGIUR_CT ON &#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_ID_VA = TI_BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDNG_ID_VA], [BDNG_AUC_STATO_LAVORAZIONE] = 1 e [BDNG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDNG_NATGIUR_CT&#xA;           (TI_BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_CODICE_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_DESCRIZ_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_MODREC_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_NSI_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_BDRG_ERI_VR&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_DATAINI_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_DATAFIN_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_FLGOBBL_VB&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_FLAG_DATABLOCPA&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_DATA_MODIFICA&#xA;           ,TI_BDNG_NATGIUR_CT.BDNG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_CODICE_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_DESCRIZ_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_MODREC_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_NSI_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_BDRG_ERI_VR&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_DATAINI_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_DATAFIN_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_FLGOBBL_VB&#xA;&#x9;&#x9;  ,BDNG_NATGIUR_CT.BDNG_FLAG_DATABLOCPA&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    BDNG_NATGIUR_CT&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDNG_NATGIUR_CT ON &#xA;--&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_ID_VA &lt;&gt; TI_BDNG_NATGIUR_CT.BDNG_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDNG_NATGIUR_CT.BDNG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDNG_NATGIUR_CT&#xA;&#x9;SET&#x9;&#x9;BDNG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDNG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\20_TI_BDSO_17 (Step 1-10)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="20_TI_BDSO_17 (Step 1-10)"
      DTS:DTSID="{ef56f923-bef8-4cb0-b64c-35a48adde055}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="20_TI_BDSO_17 (Step 1-10)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDSO_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdso (id_bdso int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdso (id_bdso, id_auc) &#xA;&#x9;   SELECT&#x9;BDSO_ID_VA, max(BDSO_AUC_CODICE_PK) FROM BDSO_SOCIETA_CL&#xA;&#x9;   WHERE&#x9;BDSO_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDSO_ID_VA&#xA;&#x9;--select * from #temp_bdso&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDSO_SOCIETA_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdso ON &#xA;&#x9;&#x9;&#x9;&#x9;BDSO_AUC_CODICE_PK &lt;&gt; #temp_bdso.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdso = BDSO_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDSO_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdso&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSO_SOCIETA_CL ON &#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_ID_VA = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;&#xA;-- 3.1 -- Scarta i record con codice fiscale assente o anomalo&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and &#xA;&#x9;(([BDSO_CODFISC_VB] is null) or (len([BDSO_CODFISC_VB]) &lt;&gt; 11 and len([BDSO_CODFISC_VB]) &lt;&gt; 16))&#xA;GO&#xA;-- 3.1.1 -- Scarta i record aventi denominazione che inizia per 'SOCIETA'' CANCELLATA PERCHE'' DUPLICATA%' &#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = -3&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and&#xA;&#x9;&#x9;&#x9;bdso_denom_vb like 'SOCIETA'' CANCELLATA PERCHE'' DUPLICATA DI%'&#xA;GO&#xA;--select * from BDSO_SOCIETA_CL where BDSO_AUC_STATO_LAVORAZIONE = -2&#xA;-- 3.2 -- Crea la posizione e imposta la presenza a zero, se resterà zero significa che la posizione è valida ma non &#xA;--        esiste su AUPOC e quindi andrà inserita, se invece diventerà 1 significa che la posizione esiste (sarà&#xA;--        valorizzato anche BDSO_AUC_AUPOC_PK) e dovrà essere modificata.&#xA;&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_POSIZIONE = BDSO_CODFISC_VB + BDSO_PROGRESS_VB,&#xA;&#x9;&#x9;&#x9;[BDSO_AUC_PRESENTE_AUPOC] = 0&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and &#xA;&#x9;([BDSO_PROGRESS_VB] is NOT null)&#xA;GO&#xA;&#xA;-- 3.3 -- Determina se il codice fiscale esiste su AUSCA&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;inner join tb_ausca_sog_contr_az on [BDSO_CODFISC_VB] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 &#xA;GO&#xA;&#xA;-- 3.4 -- Determina se la posizione esiste esiste su AUPOC appartenente all'area 3 cioè Pubblici&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_AUPOC_PK = AUPOC_CODICE_PK,&#xA;&#x9;&#x9;&#x9;[BDSO_AUC_PRESENTE_AUPOC] = 1&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;inner join tb_aupoc_pos_contr on [BDSO_POSIZIONE] = AUPOC_POSIZIONE&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and AUPOC_AUREA_CODICE_PK = 3&#xA;&#xA;&#xA;-- 3.5 -- Determina se lo stato della posizione e' attiva &#xA;&#xA;-- 3.5.1 -- Determina se lo stato della posizione e' attiva (08-03-2017)&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_POSIZIONE = 1&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and [BDSO_AUC_PRESENTE_AUPOC] &gt;= 0 AND&#xA;&#x9;(convert(date,GetDate()) &gt;= BDSO_DATAINI_VB and convert(date,GetDate())&lt;= BDSO_DATAFIN_VB) or&#xA;&#x9;(convert(date,GetDate()) &gt;= BDSO_DATAINI_VB and BDSO_DATAFIN_VB is null) &#xA;&#xA;&#x9;-- 3.5.2 -- Determina se lo stato della posizione e' chiusa definitivamente&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_POSIZIONE = 3&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and [BDSO_AUC_PRESENTE_AUPOC] &gt;= 0 AND&#xA;&#x9;(convert(date,GetDate()) &gt;= BDSO_DATAINI_VB and convert(date,GetDate())&gt; BDSO_DATAFIN_VB) &#xA;&#xA;-- 3.6 -- Valorizza la chiave esterna del codice sede Inps &#xA;--select [BDSO_CODICE_STRUT_INPS] from BDSO_SOCIETA_CL&#xA;--where [BDSO_AUC_AUSIN_CODICE_PK] is null and BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and [BDSO_AUC_PRESENTE_AUPOC] &gt;= 0&#xA;&#xA;--Aggiornamento sedi SIN Fornita da Selex&#xA;&#xA;update BDSO_SOCIETA_CL&#xA;set bdso_codice_strut_inpdap = AN.ANSOR_COD_STRUTORG_PK,&#xA;&#x9;bdso_codice_strut_inps  = AN.ANSOR_COD_SSZZINPS&#xA;  FROM BDSO_SOCIETA_CL SO,        &#xA;          BDSD_SEDESOC_CL SD,        &#xA;          BDMS_COMPSOCI_CL MS,&#xA;          TB_ANSOR_STRUTORG_CL AN     &#xA; WHERE SD.BDSD_BDSO_EDI_VR = SO.BDSO_ID_VA&#xA;   AND MS.BDMS_BDSD_SRI_VR = SD.BDSD_ID_VA&#xA;   AND SD.BDSD_BDSE_APP_VR = 1  &#xA; --AND SO.BDSO_DATAFIN_VB IS NULL    DECOMMENTARE SE SI VOGLIONO SOLO GLI ENTI APERTI&#xA;   AND SD.BDSD_DATAFINE_VB IS NULL&#xA;   AND MS.BDMS_DTFINE_VB IS NULL&#xA;   AND an.ansor_data_fine &gt; GETDATE()&#xA;   AND MS.BDMS_BDSU_SRI_VR = AN.ANSOR_BDSU_ID_VA&#xA;   and so.BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;&#xA;&#xA;-- Aggiornamento sedi Inps AUC&#xA;&#x9;UPDATE BDSO_SOCIETA_CL &#xA;&#x9;SET    [BDSO_AUC_AUSIN_CODICE_PK]= tb_ausin_sedi_inps_ct.ausin_codice_pk&#xA;&#x9;FROM   BDSO_SOCIETA_CL INNER JOIN&#xA;               tb_ausin_sedi_inps_ct ON substring([BDSO_CODICE_STRUT_INPS],1,4) = tb_ausin_sedi_inps_ct.ausin_codice_sede&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and [BDSO_AUC_PRESENTE_AUPOC] &gt;= 0 &#xA;&#xA;-- 3.7 -- Determina i dati di eventuale confluenza (&#xA;&#xA;UPDATE    BDSO_SOCIETA_CL&#xA;SET              BDSO_AUC_CF_CONFLUITO = BDSO_SOCIETA_CL_1.[BDSO_CODFISC_VB], BDSO_AUC_PROGRESSIVO_CONFLUITO = BDSO_SOCIETA_CL_1.[BDSO_PROGRESS_VB]&#xA;FROM         BDSO_SOCIETA_CL INNER JOIN&#xA;                      BDSO_SOCIETA_CL AS BDSO_SOCIETA_CL_1 ON BDSO_SOCIETA_CL.BDSO_IDBDSO_VR = BDSO_SOCIETA_CL_1.BDSO_ID_VA&#xA;WHERE     (BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1) AND (BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE_AUPOC &gt;= 0)&#xA;&#xA;-- 3.8 -- Valorizza la PEC&#xA;&#xA;UPDATE    dbo.BDSO_SOCIETA_CL&#xA;SET              BDSO_AUC_PEC = ANMPG_MAIL_PERSGIU&#xA;FROM         dbo.TB_ANMPG_MAILPGIU_CL INNER JOIN&#xA;                      dbo.BDSO_SOCIETA_CL ON dbo.TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK = dbo.BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;  where (BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1) AND anmpg_flag_pec = 'S' and getdate() &gt;= anmpg_data_iniz and getdate()&lt;=anmpg_data_fine and &#xA;  ANMPG_AUC_STATO_LAVORAZIONE = 0&#xA;&#xA;&#xA;&#xA;-- 3.9 -- Valorizza la natura giuridica&#xA;&#xA;UPDATE    dbo.BDSO_SOCIETA_CL&#xA;SET              BDSO_AUC_NATURAG = bdng_codice_vb&#xA;FROM         dbo.BDNG_NATGIUR_CT INNER JOIN&#xA;                      dbo.TB_ANNGG_NATGIURPG_CL ON dbo.BDNG_NATGIUR_CT.BDNG_ID_VA = dbo.TB_ANNGG_NATGIURPG_CL.ANNGG_BDNG_ID_VA INNER JOIN&#xA;                      dbo.BDSO_SOCIETA_CL ON dbo.TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK = dbo.BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;  where (BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1) AND getdate() &gt;= [ANNGG_DATA_INIZ_PK] and getdate()&#xA;&lt;=[ANNGG_DATA_FINE]&#xA;&#xA;&#xA;-- 3.10 -- Valorizza la forma giuridica&#xA;&#xA;UPDATE    dbo.BDSO_SOCIETA_CL&#xA;SET              BDSO_AUC_FORMAG = [ANFGI_DESCB_FORMAGIUR]&#xA;FROM         dbo.TB_ANFGG_FORMAGIURPG_CL INNER JOIN&#xA;                      dbo.BDSO_SOCIETA_CL ON dbo.TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK = dbo.BDSO_SOCIETA_CL.BDSO_ID_VA INNER JOIN&#xA;                      dbo.TB_ANFGI_FORMAGIU_CT ON &#xA;                      dbo.TB_ANFGG_FORMAGIURPG_CL.ANFGG_ANFGI_COD_FORMAGIUR = dbo.TB_ANFGI_FORMAGIU_CT.ANFGI_COD_FORMAGIUR_PK&#xA; where (BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1) AND getdate() &gt;= [ANFGG_DATA_INIZ_PK] and getdate()&#xA;&lt;=[ANFGG_DATA_FINE]&#xA;&#xA;&#xA;-- 3.11 -- Valorizza la natura giuridica AUC &#xA;--&#x9;&#x9;&#x9;ATTENZIONE se resta a NULL non viene gestito come valido INPDAP per cui viene scartato&#xA;&#xA;UPDATE    dbo.BDSO_SOCIETA_CL&#xA;SET              BDSO_AUC_AUNGI = case  bdso_bdts_app_vr &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 10 then 39&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 14 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 16 then 14&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 21 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 22 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 25 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 26 then 55&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 27 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 28 then 13&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when 30 then 93&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end &#xA; where (BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA; --3.12 Aggiorno Indirizzi&#xA; update BDSO_SOCIETA_CL&#xA; set&#xA;       BDSO_SOCIETA_CL.BDSO_TOPONIMO&#x9;&#x9;&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then ii.BDIN_TOPONOMA_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null&#x9;end&#x9;&#x9;&#x9;&#x9;&#xA;      ,BDSO_SOCIETA_CL.BDSO_COMPLEMENTO&#x9;&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then ii.BDIN_COMPLEM_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_ANIDE_SEQ_INDEST is not null then ie.ANIDE_DESCR_LINE2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null  &#x9;end &#x9;&#x9;&#x9;&#xA;      ,BDSO_SOCIETA_CL.BDSO_DESCRIZIONE&#x9;&#x9;&#x9;=&#x9;case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then ii.BDIN_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_ANIDE_SEQ_INDEST is not null then ie.ANIDE_DESCR_LINE1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null&#x9;end&#xA;      ,BDSO_SOCIETA_CL.BDSO_CIVICO&#x9;&#x9;&#x9;&#x9;=&#x9;BS.BDBS_IND_NCIV_INT_SCALA_VB&#x9;&#x9;&#x9;&#x9;&#xA;      ,BDSO_SOCIETA_CL.BDSO_FRAZIONE&#x9;&#x9;&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then II.BDIN_FRAZIONE_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null&#x9;end&#x9;&#x9;&#x9;&#x9;&#xA;      ,BDSO_SOCIETA_CL.BDSO_LOCALITA&#x9;&#x9;&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then BL.BDLC_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_ANIDE_SEQ_INDEST is not null then replace(IE.ANIDE_DESCR_CITTA, '''', '')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null&#x9;end&#xA;      ,BDSO_SOCIETA_CL.BDSO_CAP&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then BD.BDCP_CAP_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_ANIDE_SEQ_INDEST is not null then replace(IE.ANIDE_COD_ZIP_POSTALCODE, '''', '')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null end&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,BDSO_SOCIETA_CL.BDSO_SIGLA_PROVINCIA&#x9;&#x9;=&#x9;case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_BDIN_EDI_VR is not null then BLP.BDLC_SIGLA_VB&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when BS.BDBS_ANIDE_SEQ_INDEST is not null then replace(IE.ANIDE_DESCR_STATE_PROV_REGION, '''', '')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else null end&#xA;&#x9;FROM    BDSO_SOCIETA_CL so&#xA;&#x9;&#xA; left join BDSD_SEDESOC_CL se&#xA;   on se.BDSD_BDSO_EDI_VR = so.BDSO_ID_VA&#xA;  --and se.BDSD_DATAFINE_VB is null&#xA;  and se.BDSD_BDSE_APP_VR = 1&#xA; left join BDBS_INDASEDE_SIN bs&#xA;   on BS.BDBS_BDSD_EDI_VR = SE.BDSD_ID_VA&#xA;  and BS.BDBS_DATAFIN_VB  is null&#xA; left join BDIN_INDIRIZ_SIN ii&#xA;   on BS.BDBS_BDIN_EDI_VR = II.BDIN_ID_VA&#xA;  and ii.BDIN_DATAFINE_VB is null&#xA; left join TB_ANIDE_INDEST_CL ie&#xA;   on BS.BDBS_ANIDE_SEQ_INDEST = IE.ANIDE_SEQ_INDEST_PK&#xA;  and ie.ANIDE_DATA_FINE &gt; getdate()&#xA; left join BDCP_CAP_CL BD&#xA;   on II.BDIN_BDCP_ERI_VR = BD.BDCP_ID_VA&#xA;  AND BD.BDCP_DATAFINE_VB is null&#xA; left join BDLC_LOCALITA_CL BL&#xA;   on II.BDIN_BDLC_APP_VR = BL.BDLC_ID_VA&#xA;  AND BL.BDLC_DTFIN_VB is null&#xA; left join BDLC_LOCALITA_CL BLP&#xA;   on BL.BDLC_BDLC_APP_VR = BLP.BDLC_ID_VA&#xA;  AND BLP.BDLC_DTFIN_VB is null&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;so.BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDSO_ID_VA], [BDSO_AUC_STATO_LAVORAZIONE] = 1 e &#xA;--      [BDSO_AUC_PRESENTE] = 1&#xA;&#xA;UPDATE&#x9;TI_BDSO_SOCIETA_CL      &#xA;&#x9;SET&#x9;TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_ID_VA&#x9;&#x9;&#x9;&#xA;&#x9;  ,TI_BDSO_SOCIETA_CL.BDSO_BDNG_EDI_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_BDNG_EDI_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_BDTS_APP_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_BDTS_APP_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CONTGESC_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CONTGESC_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATAFIN_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATAFIN_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATAINI_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATAINI_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DENOM_VB&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DENOM_VB&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLGOPZ_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLGOPZ_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_PIVA_VB&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_PIVA_VB&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_TIMELOCK_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_TIMELOCK_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_MODREC_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CERTIF_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CERTIF_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_PROGRESS_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_PROGRESS_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_IDBDSO_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_IDBDSO_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_BDST_ERI_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_BDST_ERI_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_UTENTE_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_UTENTE_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DTVAR_VB&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DTVAR_VB&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_BDSO_REC_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_BDSO_REC_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLSOSIMP_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLSOSIMP_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLAPPART_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLAPPART_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLSEDSER_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLSEDSER_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLVERSAN_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLVERSAN_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DTFCOMPE_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DTFCOMPE_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_ANATE_APP_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_ANATE_APP_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_ANFGI_APP_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_ANFGI_APP_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CERTISCR_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CERTISCR_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_MAINIDMA_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_MAINIDMA_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CODINPS_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CODINPS_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DENOMB_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DENOMB_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLGECCOMP_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLGECCOMP_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_BDSO_VIG_VR&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_BDSO_VIG_VR&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FLGERR_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FLGERR_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_MAFINDMA_VB&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_MAFINDMA_VB&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_ANTLI_COD_TIPLIQUID&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_ANTLI_COD_TIPLIQUID&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATA_LIQUID&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATA_LIQUID&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATA_BLOCCOPA&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATA_BLOCCOPA&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATA_INIZGESCEN&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATA_INIZGESCEN&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATA_FINEGESCEN&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DATA_FINEGESCEN&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_TOPONIMO&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_TOPONIMO&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_COMPLEMENTO&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_COMPLEMENTO&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DESCRIZIONE&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_DESCRIZIONE&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CIVICO&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CIVICO&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_FRAZIONE&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_FRAZIONE&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_LOCALITA&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_LOCALITA&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CAP&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CAP&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_SIGLA_PROVINCIA&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_SIGLA_PROVINCIA&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPDAP&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPDAP&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPS&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPS&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUSCA_PK&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_AUC_AUSCA_PK&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_POSIZIONE&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_POSIZIONE&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE_AUPOC&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE_AUPOC&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#x9;&#x9;&#x9;=&#x9;BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#x9;&#x9;&#x9;&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#x9;&#xA;      ,TI_BDSO_SOCIETA_CL.BDSO_DESCR_UTENTE&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_STATO_POSIZIONE] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_STATO_POSIZIONE] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_AUSIN_CODICE_PK] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_AUSIN_CODICE_PK] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_CF_CONFLUITO] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_CF_CONFLUITO] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_PROGRESSIVO_CONFLUITO] &#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_PROGRESSIVO_CONFLUITO] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_PEC] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_PEC] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_FORMAG] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_FORMAG] &#xA;      ,TI_BDSO_SOCIETA_CL.[BDSO_AUC_NATURAG] &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.[BDSO_AUC_NATURAG] &#xA;&#x9;  ,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUNGI &#x9;&#x9;&#x9;= BDSO_SOCIETA_CL.BDSO_AUC_AUNGI &#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSO_SOCIETA_CL ON &#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_ID_VA = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDSO_ID_VA], [BDSO_AUC_STATO_LAVORAZIONE] = 1 e &#xA;--[BDSO_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDSO_SOCIETA_CL&#xA;           (TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;    ,TI_BDSO_SOCIETA_CL.BDSO_BDNG_EDI_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_BDTS_APP_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CONTGESC_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATAFIN_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATAINI_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DENOM_VB&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLGOPZ_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_PIVA_VB&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_TIMELOCK_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_MODREC_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CERTIF_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_PROGRESS_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_IDBDSO_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_BDST_ERI_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_UTENTE_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DTVAR_VB&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_BDSO_REC_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLSOSIMP_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLAPPART_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLSEDSER_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLVERSAN_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DTFCOMPE_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_ANATE_APP_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_ANFGI_APP_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CERTISCR_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_MAINIDMA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CODINPS_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DENOMB_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLGECCOMP_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_BDSO_VIG_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FLGERR_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_MAFINDMA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_ANTLI_COD_TIPLIQUID&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATA_LIQUID&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATA_BLOCCOPA&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATA_INIZGESCEN&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATA_FINEGESCEN&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_TOPONIMO&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_COMPLEMENTO&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DESCRIZIONE&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CIVICO&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_FRAZIONE&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_LOCALITA&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CAP&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_SIGLA_PROVINCIA&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPDAP&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPS&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUSCA_PK&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_POSIZIONE&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE_AUPOC&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DATA_MODIFICA&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_DESCR_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_STATO_POSIZIONE] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_AUSIN_CODICE_PK] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_CF_CONFLUITO] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_PROGRESSIVO_CONFLUITO] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_PEC] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_FORMAG] &#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.[BDSO_AUC_NATURAG]&#xA;&#x9;&#x9;&#x9;,TI_BDSO_SOCIETA_CL.BDSO_AUC_AUNGI &#xA;)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_BDNG_EDI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_BDTS_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CONTGESC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATAFIN_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATAINI_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DENOM_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLGOPZ_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_PIVA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_TIMELOCK_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_MODREC_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CERTIF_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_PROGRESS_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_IDBDSO_VR&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_BDST_ERI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_UTENTE_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DTVAR_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_BDSO_REC_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLSOSIMP_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLAPPART_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLSEDSER_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLVERSAN_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DTFCOMPE_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_ANATE_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_ANFGI_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CERTISCR_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_MAINIDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CODINPS_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DENOMB_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLGECCOMP_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_BDSO_VIG_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FLGERR_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_MAFINDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_ANTLI_COD_TIPLIQUID&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATA_LIQUID&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATA_BLOCCOPA&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATA_INIZGESCEN&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DATA_FINEGESCEN&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_TOPONIMO&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_COMPLEMENTO&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_DESCRIZIONE&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CIVICO&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_FRAZIONE&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_LOCALITA&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CAP&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_SIGLA_PROVINCIA&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPDAP&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_CODICE_STRUT_INPS&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_AUC_AUSCA_PK&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_POSIZIONE&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE_AUPOC&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,GetDate()&#x9;&#xA;&#x9;&#x9;&#x9;,'Inserimento pubblici'&#x9;&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_STATO_POSIZIONE] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_AUSIN_CODICE_PK] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_CF_CONFLUITO] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_PROGRESSIVO_CONFLUITO] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_PEC] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_FORMAG] &#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.[BDSO_AUC_NATURAG]&#xA;&#x9;&#x9;&#x9;,BDSO_SOCIETA_CL.BDSO_AUC_AUNGI&#xA;&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDSO_SOCIETA_CL ON &#xA;--&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_ID_VA &lt;&gt; TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;&#xA;&#xA;-- 6 -- Inserimento su AUSCA dei BDSO non presenti su AUSCA&#xA;--      Dal momento che i record che hanno AUNGI a NULL sono scartati &#xA;--      quelli che si inseriscono sono interpretati come certificati da INPS&#xA;&#xA;  &#x9;INSERT INTO [dbo].[tb_ausca_sog_contr_az] (&#xA;&#x9;&#x9;    [ausca_codice_fiscale]&#xA;&#x9;&#x9;    ,ausca_denominazione&#xA;&#x9;&#x9;    ,ausca_aungi_codice_pk&#xA;--           &#x9;,[ausca_codice_qualita_ind]&#xA;--           &#x9;,[ausca_codice_toponimo]&#xA;           &#x9;,[ausca_toponimo]&#xA;           &#x9;,[ausca_indirizzo]&#xA;           &#x9;,[ausca_civico]&#xA;           &#x9;,[ausca_sede_legale_italia]&#xA;--&#x9;&#x9;,ausca_codice_comune&#xA;           &#x9;,[ausca_descr_comune]&#xA;           &#x9;,[ausca_sigla_provincia]&#xA;&#x9;&#x9;&#x9;,ausca_Stato&#xA;&#x9;&#x9;    ,[ausca_cap]&#xA;&#x9;&#x9;    ,AUSCA_FRAZIONE&#xA;           &#x9;,[ausca_soggetto_certificato]&#xA;           &#x9;,[ausca_auten_codice_pk]&#xA;           &#x9;,[ausca_codice_entita_rif]&#xA;           &#x9;,[ausca_cert_auten_cod_pk]&#xA;           &#x9;,[ausca_cert_cod_entita_rif]&#xA;&#x9;&#x9;&#x9;,ausca_cert_data_modifica&#xA;           &#x9;,[ausca_note]&#xA;&#x9;&#x9;    ,ausca_data_inizio_attivita&#xA;&#x9;&#x9;    ,ausca_data_fine_attivita&#xA;--&#x9;&#x9;,ausca_ateco&#xA;--&#x9;&#x9;,ausca_auate_2002_codice_pk&#xA;           &#x9;,[ausca_data_modifica]&#xA;           &#x9;,[ausca_descr_utente]&#xA;&#x9;&#x9;&#x9;,ausca_piva&#xA;&#x9;&#x9;&#x9;,ausca_bdso_id_va_inpdap&#xA;&#x9;&#x9;&#x9;,ausca_pec&#xA;&#x9;&#x9;&#x9;,ausca_pec_sin&#xA;&#x9;&#x9;&#x9;,ausca_telefono1&#xA;&#x9;&#x9;&#x9;,ausca_telefono2&#xA;&#x9;&#x9;&#x9;,ausca_telefono3&#xA;&#x9;&#x9;&#x9;,ausca_fax&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;(&#xA; &#x9;select    upper([BDSO_CODFISC_VB]) as cf&#xA;&#x9;&#x9;, BDSO_DENOM_VB&#xA;&#x9;&#x9;,BDSO_AUC_AUNGI&#xA;--           &#x9;,[AUAAC_IND_QLA_IND_AZ]&#xA;--           &#x9;,substring([AUAAC_COD_TOPO_IND_AZ],1,3)&#xA;        ,[BDSO_TOPONIMO]&#xA;        ,[BDSO_DESCRIZIONE]&#xA;        ,[BDSO_CIVICO]&#xA;&#x9;&#x9;,'S' as sedeItalia&#xA;--&#x9;&#x9;,[auaac_cod_com_az]&#xA;        ,substring([BDSO_LOCALITA],1,30)&#xA;        ,case len([BDSO_SIGLA_PROVINCIA]) when 2 then [BDSO_SIGLA_PROVINCIA] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else 'EE' end &#xA;&#x9;&#x9; end&#xA;        ,case len([BDSO_SIGLA_PROVINCIA]) when 2 then null &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else [BDSO_SIGLA_PROVINCIA] end &#xA;&#x9;&#x9; end&#xA;&#x9;&#x9;,[BDSO_CAP]&#xA;&#x9;&#x9;,BDSO_FRAZIONE&#xA;&#x9;&#x9;,'N' as Certificato&#xA;&#x9;&#x9;,3 as tipoEntita&#xA;&#x9;&#x9;,1 as Applicazione_Pubblici&#xA;&#x9;&#x9;,2 as tipoEntitaCert&#xA;&#x9;&#x9;,2 as Certificatore_Pubblici&#xA;&#x9;&#x9;,getdate() as data_certificazione&#xA;&#x9;&#x9;,'Proveniente da Pubblici' as Note&#xA;        ,[BDSO_DATAINI_VB]&#xA;        ,[BDSO_DATAFIN_VB]&#xA;--&#x9;&#x9;,[auaac_cod_ateco02]&#xA;--&#x9;&#x9;,auaac_auate&#xA;&#x9;&#x9;,getdate() as DataModifica&#xA;&#x9;&#x9;,'Pubblici' as DescrUtente&#xA;&#x9;&#x9;,BDSO_PIVA_VB&#xA;&#x9;&#x9;,BDSO_ID_VA&#xA;        ,[BDSO_AUC_PEC]&#xA;&#x9;&#x9;,[BDSO_AUC_PEC]&#xA;&#x9;&#x9;,'000000'&#xA;&#x9;&#x9;,'000000'&#xA;&#x9;&#x9;,'000000'&#xA;&#x9;&#x9;,'000000'&#xA;&#x9;from dbo.BDSO_SOCIETA_CL &#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;--BDSO_SOCIETA_CL.BDSO_AUC_PRESENTE = 0 and &#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUSCA_PK is null OR BDSO_AUC_AUSCA_PK = 0) and BDSO_PROGRESS_VB = '00000' and bdso_auc_aungi is not null &#xA;&#x9;)&#xA;&#xA;-- 7 -- Riconosce i record appena inseriti su AUSCA per lo storico dei dati ed AUCFI&#xA;&#xA;&#x9;UPDATE  dbo.BDSO_SOCIETA_CL &#xA;&#x9;SET  &#x9;BDSO_AUC_PRESENTE = 2, BDSO_AUC_AUSCA_PK = ausca_codice_pk&#xA;&#x9;FROM &#x9;BDSO_SOCIETA_CL INNER JOIN&#xA;                         tb_ausca_sog_contr_az ON BDSO_SOCIETA_CL.[BDSO_CODFISC_VB] = tb_ausca_sog_contr_az.ausca_codice_fiscale&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUSCA_PK is null OR BDSO_AUC_AUSCA_PK = 0) and BDSO_PROGRESS_VB = '00000' and bdso_auc_aungi is not null&#xA;&#xA;-- 8 -- Modifica su AUSCA dei BDSO presenti su AUSCA considera solo i progressivi 00000 e se il soggetto è certificato INPS&#xA;&#xA;&#xA;UPDATE  tb_ausca_sog_contr_az&#xA;SET     AUSCA_DENOMINAZIONE = isnull(BDSO_DENOM_VB,AUSCA_DENOMINAZIONE)&#xA;&#x9;&#x9;,ausca_toponimo = isnull([BDSO_TOPONIMO],ausca_toponimo)&#xA;&#x9;&#x9;,ausca_indirizzo = isnull([BDSO_DESCRIZIONE],ausca_indirizzo)&#xA;&#x9;&#x9;,ausca_civico = isnull([BDSO_CIVICO], ausca_civico)&#xA;&#x9;&#x9;,ausca_sigla_provincia = case len([BDSO_SIGLA_PROVINCIA]) when 2 then [BDSO_SIGLA_PROVINCIA] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else 'EE' end &#xA;&#x9;&#x9;                         end &#xA;&#x9;&#x9;,ausca_stato = case len([BDSO_SIGLA_PROVINCIA]) when 2 then null &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else [BDSO_SIGLA_PROVINCIA] end &#xA;&#x9;&#x9;               end&#xA;&#x9;&#x9;,ausca_descr_comune = isnull(substring([BDSO_LOCALITA],1,30), ausca_descr_comune)&#xA;&#x9;&#x9;,ausca_cap = isnull([BDSO_CAP],ausca_cap)&#xA;&#x9;&#x9;,AUSCA_FRAZIONE = isnull(BDSO_FRAZIONE,AUSCA_FRAZIONE)&#xA;&#x9;&#x9;,AUSCA_PIVA = isnull(BDSO_PIVA_VB,AUSCA_PIVA)&#xA;&#x9;&#x9;,ausca_bdso_id_va_inpdap = BDSO_ID_VA&#xA;&#x9;&#x9;,ausca_data_modifica = getdate() &#xA;&#x9;&#x9;,ausca_descr_utente = 'Modifica Inpdap'&#xA;&#x9;&#x9;,ausca_pec = isnull([BDSO_AUC_PEC],ausca_pec)&#xA;&#x9;&#x9;,ausca_pec_sin = isnull([BDSO_AUC_PEC],ausca_pec_sin)&#xA;&#x9;&#x9;,ausca_aungi_codice_pk = BDSO_AUC_AUNGI&#xA;FROM            tb_ausca_sog_contr_az INNER JOIN&#xA;                         BDSO_SOCIETA_CL ON tb_ausca_sog_contr_az.ausca_codice_pk = BDSO_SOCIETA_CL.[BDSO_AUC_AUSCA_PK]&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUSCA_PK is NOT null AND BDSO_AUC_AUSCA_PK &lt;&gt; 0) and BDSO_PROGRESS_VB = '00000' and bdso_auc_aungi is not null&#xA;&#x9;&#x9;&#x9;AND [ausca_soggetto_certificato] = 'S' and [ausca_cert_auten_cod_pk] = 2 and [ausca_cert_cod_entita_rif] = 2&#xA;&#xA;&#xA;&#xA;-- 9.A -- Inserimento record su AUCFI e calcolo controcodice&#xA;&#xA;&#x9;DECLARE CURSORE_AUCFI Cursor&#xA;&#x9;FOR&#xA;&#x9;SELECT  upper([BDSO_CODFISC_VB]), BDSO_AUC_AUSCA_PK&#xA;&#x9;&#x9;from [dbo].BDSO_SOCIETA_CL &#xA;&#x9;WHERE        (BDSO_AUC_STATO_LAVORAZIONE = 1) and BDSO_AUC_PRESENTE = 2 &#xA;      &#xA;     &#x9;OPEN CURSORE_AUCFI &#xA;      &#xA;    &#x9;Declare @CF Varchar(16) &#xA;&#x9;&#x9;Declare @codice_pk int   &#xA; &#xA;    &#x9;FETCH NEXT FROM CURSORE_AUCFI INTO @CF, @Codice_pk&#xA;&#x9;&#x9;WHILE (@@FETCH_STATUS = 0)&#x9;&#x9;&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;INSERT INTO [AUC].[dbo].[tb_aucfi_cod_fiscale]&#xA;&#x9;&#x9;&#x9;&#x9;([aucfi_ausca_codice_pk]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_data_inizio_validita]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_data_fine_validita]&#xA;&#x9;&#x9;&#x9;&#x9;,aucfi_codice_fiscale&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_data_modifica]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_descr_utente]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_codice_pk_db2]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_rec_del]&#xA;&#x9;&#x9;&#x9;&#x9;,[aucfi_data_del])&#xA;&#x9;&#x9;VALUES(@Codice_pk, GETDATE(), null, upper(@CF), GETDATE(), 'Proveniente da Inpdap', 0, null, null)&#x9;&#xA;&#xA;&#x9;&#x9;EXEC AZ_VALIDA_CC @Codice_pk, 'AUSCA';&#x9;&#xA;&#xA;&#x9;&#x9;FETCH NEXT FROM CURSORE_AUCFI INTO @CF, @Codice_pk&#xA;&#x9;END&#xA;&#x9;CLOSE CURSORE_AUCFI&#xA;&#x9;DEALLOCATE CURSORE_AUCFI&#xA;&#xA;&#xA;-- 9.B -- Inserimento record su AUVAR&#xA;&#xA;&#x9;DECLARE CURSORE_AUVAR Cursor&#xA;&#x9;FOR&#xA;&#x9;SELECT  upper([BDSO_CODFISC_VB]), BDSO_AUC_AUSCA_PK&#xA;&#x9;&#x9;from [dbo].BDSO_SOCIETA_CL&#xA;&#x9;inner join tb_ausca_sog_contr_az on ausca_codice_pk = BDSO_AUC_AUSCA_PK&#xA;&#x9;WHERE       ((BDSO_AUC_STATO_LAVORAZIONE = 1) and BDSO_AUC_PRESENTE = 2)  or -- condizione di inserimento&#xA;           -- condizione di modifica &#xA;&#x9;&#x9;&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUSCA_PK is NOT null AND BDSO_AUC_AUSCA_PK &lt;&gt; 0) and BDSO_PROGRESS_VB = '00000' and bdso_auc_aungi is not null&#xA;&#x9;&#x9;&#x9;AND [ausca_soggetto_certificato] = 'S' and [ausca_cert_auten_cod_pk] = 2 and [ausca_cert_cod_entita_rif] = 2&#xA;&#x9;   &#xA;     &#x9;OPEN CURSORE_AUVAR &#xA;      &#xA;    &#x9;Declare @CF1 Varchar(16) &#xA;&#x9;&#x9;Declare @codice_pk1 int   &#xA; &#xA;    &#x9;FETCH NEXT FROM CURSORE_AUVAR INTO @CF1, @Codice_pk1&#xA;&#x9;&#x9;WHILE (@@FETCH_STATUS = 0)&#x9;&#x9;&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;EXEC AZ_1_SINCRONIZZA @Codice_pk1, '3', '1';&#x9;&#xA;&#xA;&#x9;&#x9;FETCH NEXT FROM CURSORE_AUVAR INTO @CF1, @Codice_pk1&#xA;&#x9;END&#xA;&#x9;CLOSE CURSORE_AUVAR&#xA;&#x9;DEALLOCATE CURSORE_AUVAR&#xA;&#xA;-- 10 -- Inserimento posizione contributiva&#xA;&#xA;&#x9;INSERT INTO [dbo].[tb_aupoc_pos_contr] (&#xA;        &#x9; [aupoc_ausca_codice_pk]&#xA;           &#x9;,[aupoc_auapp_codice_pk]&#xA;           &#x9;,[aupoc_auspc_codice_pk]&#xA;&#x9;&#x9;    ,[aupoc_posizione]&#xA;           &#x9;,[aupoc_data_inizio_attivita]&#xA;&#x9;&#x9;    ,[aupoc_denom_posiz_contr]&#xA;           &#x9;,[aupoc_note]&#xA;--           &#x9;,[aupoc_data_domanda_iscr]&#xA;&#x9;&#x9;    ,aupoc_cod_sede_INPS&#xA;           &#x9;,[aupoc_data_modifica]&#xA;           &#x9;,[aupoc_descr_utente]&#xA;--&#x9;&#x9;    ,aupoc_ateco&#xA;--&#x9;&#x9;    ,aupoc_auate_2002_codice_pk&#xA;           &#x9;,[aupoc_ausin_codice_pk]&#xA;           &#x9;,[aupoc_aurea_codice_pk]&#xA;           &#x9;,[aupoc_tipo_posizione]&#xA;&#x9;&#x9;    ,aupoc_data_ultimo_stato&#xA;---&#x9;&#x9;&#x9;,[aupoc_ente_dichiarante_INPDAP]&#xA;&#x9;&#x9;&#x9;,[aupoc_ente_appartenenza_INPDAP]&#xA;&#x9;&#x9;&#x9;,[aupoc_sede_servizio_INPDAP]&#xA;&#x9;&#x9;&#x9;,[aupoc_ente_versante_INPDAP]&#xA;&#x9;&#x9;&#x9;,aupoc_id_sin&#xA;&#x9;&#x9;&#x9;,aupoc_id_confluito&#xA;&#x9;&#x9;&#x9;,aupoc_cf_confluito&#xA;&#x9;&#x9;&#x9;,aupoc_progressivo_confluito&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;( &#xA;&#x9;select&#xA;            BDSO_AUC_AUSCA_PK as codice_ausca&#xA;&#x9;&#x9;&#x9;,1 as AUAPP&#xA;&#x9;&#x9;&#x9;,bdso_auc_stato_posizione as auspc&#xA;    &#x9;&#x9;,BDSO_POSIZIONE as posizione&#xA;&#x9;&#x9;&#x9;,BDSO_DATAINI_VB as data_inizio&#xA;&#x9;&#x9;&#x9;,BDSO_DENOM_VB as denominazione&#xA;&#x9;&#x9;&#x9;,'Proveniente da Inpdap' as Note&#xA;--           &#x9;,[auaac_data_domanda]&#xA;&#x9;&#x9;&#x9;,BDSO_CODICE_STRUT_INPS&#xA;&#x9;&#x9;&#x9;,getdate()&#xA;&#x9;&#x9;&#x9;,'Inpdap' as DescrUtente&#xA;--&#x9;&#x9;&#x9;,auaac_cod_ateco02&#xA;--&#x9;&#x9;&#x9;,auaac_auate&#xA;&#x9;&#x9;&#x9;,[BDSO_AUC_AUSIN_CODICE_PK] as SedeInps&#xA;&#x9;&#x9;&#x9;,3 as AUREA&#xA;&#x9;&#x9;&#x9;,0 as Tipo_posizione&#xA;&#x9;&#x9;&#x9;,case bdso_auc_stato_posizione&#xA;&#x9;&#x9; &#x9;when 1 then null&#xA;&#x9;&#x9;&#x9;else BDSO_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;end as dataUltimoStato&#xA;---&#x9;&#x9;&#x9;,&#xA;&#x9;&#x9;&#x9;,BDSO_FLAPPART_VB as Appartenenza&#xA;&#x9;&#x9;&#x9;,BDSO_FLSEDSER_VB as SedeServizio&#xA;&#x9;&#x9;&#x9;,BDSO_FLVERSAN_VB as Versante&#xA;&#x9;&#x9;&#x9;,[BDSO_ID_VA]&#xA;&#x9;&#x9;&#x9;,[BDSO_BDSO_VIG_VR]&#xA;&#x9;&#x9;&#x9;,BDSO_AUC_CF_Confluito&#xA;&#x9;&#x9;&#x9;,BDSO_AUC_Progressivo_confluito&#xA;&#x9;   from [dbo].BDSO_SOCIETA_CL&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is null OR BDSO_AUC_AUPOC_PK = 0) and BDSO_AUC_PRESENTE_AUPOC = 0 and bdso_auc_aungi is not null&#xA; )&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\20_TI_BDSO_17 (Step 11-17)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="20_TI_BDSO_17 (Step 11-17)"
      DTS:DTSID="{90224733-1734-4e01-aa2d-f66fdf1e258e}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="20_TI_BDSO_17 (Step 11-17)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 11 -- Riconoscimento delle posizioni contributive inserite&#xA;&#xA;&#x9;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;BDSO_AUC_AUPOC_PK = AUPOC_CODICE_PK,&#xA;&#x9;&#x9;&#x9;[BDSO_AUC_PRESENTE_AUPOC] = 2&#xA;&#x9;FROM    BDSO_SOCIETA_CL&#x9;inner join tb_aupoc_pos_contr on [BDSO_POSIZIONE] = AUPOC_POSIZIONE&#xA;&#x9;WHERE&#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1 and AUPOC_AUREA_CODICE_PK = 3 and BDSO_AUC_PRESENTE_AUPOC = 0&#xA;&#xA;&#xA;-- 12-- Modifica della posizione contributiva&#xA;UPDATE       tb_aupoc_pos_contr&#xA;SET&#x9;&#x9;&#xA;           &#x9;[aupoc_auspc_codice_pk] = bdso_auc_stato_posizione&#xA;           &#x9;,[aupoc_data_inizio_attivita] = BDSO_DATAINI_VB&#xA;&#x9;&#x9;    ,[aupoc_denom_posiz_contr] = BDSO_DENOM_VB&#xA;           &#x9;,[aupoc_note] = 'Modifica Proveniente da Inpdap'&#xA;--           &#x9;,[aupoc_data_domanda_iscr]&#xA;&#x9;&#x9;    ,aupoc_cod_sede_INPS = BDSO_CODICE_STRUT_INPS&#xA;           &#x9;,[aupoc_data_modifica] = getdate()&#xA;           &#x9;,[aupoc_descr_utente] = 'Modifica Inpdap'&#xA;--&#x9;&#x9;    ,aupoc_ateco&#xA;--&#x9;&#x9;    ,aupoc_auate_2002_codice_pk&#xA;           &#x9;,[aupoc_ausin_codice_pk] = [BDSO_AUC_AUSIN_CODICE_PK]&#xA;&#x9;&#x9;    ,aupoc_data_ultimo_stato = case bdso_auc_stato_posizione&#xA;&#x9;&#x9; &#x9;when 1 then null&#xA;&#x9;&#x9;&#x9;else BDSO_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;end&#xA;---&#x9;&#x9;&#x9;,[aupoc_ente_dichiarante_INPDAP]&#xA;&#x9;&#x9;&#x9;,[aupoc_ente_appartenenza_INPDAP] = BDSO_FLAPPART_VB&#xA;&#x9;&#x9;&#x9;,[aupoc_sede_servizio_INPDAP] = BDSO_FLSEDSER_VB&#xA;&#x9;&#x9;&#x9;,[aupoc_ente_versante_INPDAP] = BDSO_FLVERSAN_VB&#xA;&#x9;&#x9;&#x9;,aupoc_id_sin = [BDSO_ID_VA]&#xA;&#x9;&#x9;&#x9;,aupoc_id_confluito = bdso_idbdso_vr             -- [BDSO_BDSO_VIG_VR]        G.C. 20201113 - Modifica indicata da Raffaele Palmieri con mail del 13/12/2020 &quot;Reingegnerizzazione servizi on line ENTI&quot;&#xA;&#x9;&#x9;&#x9;,aupoc_cf_confluito = [BDSO_AUC_CF_CONFLUITO]&#xA;&#x9;&#x9;&#x9;,aupoc_progressivo_confluito = [BDSO_AUC_PROGRESSIVO_CONFLUITO]&#xA;&#xA;FROM            tb_aupoc_pos_contr INNER JOIN&#xA;                         BDSO_SOCIETA_CL ON tb_aupoc_pos_contr.aupoc_codice_pk = BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and BDSO_AUC_PRESENTE_AUPOC = 1 and aupoc_aurea_codice_pk = 3 and bdso_auc_aungi is not null&#xA;&#xA;-- Giuseppe Colloca - 07/10/2020&#xA;--12.1 -- Cancellazione posizioni con natura giuridica passata da ammissibile a non ammissibile&#xA;&#x9;DECLARE @PosizioniDaCancellare TABLE ( pk INT )&#xA;&#xA;&#x9;INSERT INTO @PosizioniDaCancellare&#xA;&#x9;SELECT aupoc_codice_pk&#xA;&#x9;FROM tb_aupoc_pos_contr&#xA;&#x9;&#x9;JOIN BDSO_SOCIETA_CL&#xA;&#x9;&#x9;&#x9;ON tb_aupoc_pos_contr.aupoc_codice_pk = BDSO_SOCIETA_CL.BDSO_AUC_AUPOC_PK&#xA;&#x9;WHERE BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;&#x9;  AND ( BDSO_AUC_AUPOC_PK IS NOT NULL AND BDSO_AUC_AUPOC_PK &lt;&gt; 0 )&#xA;&#x9;&#x9;  AND BDSO_AUC_PRESENTE_AUPOC = 1&#xA;&#x9;&#x9;  AND aupoc_aurea_codice_pk = 3&#xA;&#x9;&#x9;  AND BDSO_AUC_AUNGI IS NULL&#xA;&#xA;&#x9;DELETE tb_auind_indirizzi&#x9;&#x9;&#x9;&#x9;WHERE auind_tabella = 'AUPOC' AND auind_tabella_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aupco_periodo_contr&#x9;&#x9;&#x9;WHERE aupco_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aupcs_periodo_contr_storico&#x9;WHERE aupcs_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aurad_rel_az_del&#x9;&#x9;&#x9;&#x9;WHERE aurad_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aurpp_rel_poc_poc&#x9;&#x9;&#x9;&#x9;WHERE aurpp_aupoc_cod_pk_figlia IN (SELECT pk FROM @PosizioniDaCancellare) or aurpp_aupoc_cod_pk_madre IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aursp_rel_sog_pos&#x9;&#x9;&#x9;&#x9;WHERE aursp_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_auuop_unita_operativa&#x9;&#x9;&#x9;WHERE auuop_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_auvas_var_stato_pos&#x9;&#x9;&#x9;WHERE auvas_aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#x9;DELETE tb_aupoc_pos_contr&#x9;&#x9;&#x9;&#x9;WHERE aupoc_codice_pk IN (SELECT pk FROM @PosizioniDaCancellare)&#xA;&#xA;-- 13 -- Cancellazione LOGICA AUIND&#xA;&#x9;UPDATE   tb_auind_indirizzi&#xA;&#x9;SET      auind_rec_del = 'S', auind_data_del = GETDATE()&#xA;&#x9;FROM     BDSO_SOCIETA_CL INNER JOIN&#xA;                 tb_auind_indirizzi ON BDSO_AUC_AUPOC_PK = tb_auind_indirizzi.auind_tabella_codice_pk &#xA;  &#x9;where &#x9;auind_tabella = 'AUPOC' and auind_aurea_codice_pk = 3 and BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and bdso_auc_aungi is not null&#xA;&#xA;--delete tb_auind_indirizzi&#xA;--WHERE auind_rec_del = 'S'&#xA;&#xA;-- 14 -- Cancellazione LOGICA AUVAS&#xA;UPDATE tb_auvas_var_stato_pos&#xA;SET auvas_rec_del = 'S', auvas_data_del = getdate()&#xA;&#x9;FROM     BDSO_SOCIETA_CL INNER JOIN&#xA;&#x9;tb_auvas_var_stato_pos on BDSO_AUC_AUPOC_PK = auvas_aupoc_codice_pk&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and bdso_auc_aungi is not null&#xA;&#xA;--delete tb_auvas_var_stato_pos&#xA;--where auvas_rec_del = 'S'&#xA;&#xA;-- 15 -- Inserimento AUIND&#xA;&#x9;INSERT INTO [dbo].[tb_auind_indirizzi] (&#xA;&#x9;&#x9;     [auind_lingua]&#xA;           &#x9;,[auind_tabella]&#xA;           &#x9;,[auind_tabella_codice_pk]&#xA;--           &#x9;,[auind_codice_toponimo]&#xA;           &#x9;,[auind_toponimo]&#xA;           &#x9;,[auind_indirizzo]&#xA;           &#x9;,[auind_civico]&#xA;--&#x9;&#x9;&#x9;,auind_codice_comune&#xA;           &#x9;,[auind_descr_comune]&#xA;           &#x9;,[auind_sigla_provincia]&#xA;&#x9;&#x9;&#x9;,auind_descr_stato_estero&#xA;           &#x9;,[auind_cap]&#xA;           &#x9;,[auind_chiave_interna]&#xA;           &#x9;,[auind_chiave_esterna]&#xA;           &#x9;,[auind_gestore_indirizzo]&#xA;--           &#x9;,[auind_codice_qualita_ind]&#xA;           &#x9;,[auind_data_modifica]&#xA;           &#x9;,[auind_descr_utente]&#xA;           &#x9;,[auind_aurea_codice_pk] )&#xA;&#x9;(&#xA;&#x9;select&#x9;'ITALIANO' as lingua&#xA;&#x9;&#x9;    ,'AUPOC' as tabella&#xA;&#x9;&#x9;    ,BDSO_AUC_AUPOC_PK&#xA;--           &#x9;,[AUAAC_COD_TOPO_IND_AZ]&#x9;&#x9;           &#xA;           &#x9;,[BDSO_TOPONIMO]&#x9;&#x9;   &#xA;           &#x9;,case &#xA;&#x9;&#x9;&#x9; when isnull([BDSO_COMPLEMENTO],'-') = '-' then [BDSO_DESCRIZIONE]&#xA;&#x9;&#x9;&#x9; else [BDSO_COMPLEMENTO] + ' '+ [BDSO_DESCRIZIONE] end as indirizzo&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;   &#x9;    ,[BDSO_CIVICO]&#x9;   &#xA;--&#x9;&#x9;,auaac_cod_com_az&#xA;           &#x9;,substring([BDSO_LOCALITA],1,50)&#x9;   &#xA;&#x9;&#x9;    ,case len([BDSO_SIGLA_PROVINCIA]) when 2 then [BDSO_SIGLA_PROVINCIA] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else 'EE' end &#xA;&#x9;&#x9;     end &#xA;&#x9;&#x9;    ,case len([BDSO_SIGLA_PROVINCIA]) when 2 then null &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else case isnull([BDSO_SIGLA_PROVINCIA],'--') when '--' then null else [BDSO_SIGLA_PROVINCIA] end &#xA;&#x9;&#x9;     end&#xA;&#x9;&#x9;    ,substring([BDSO_CAP],1,5)&#xA;&#x9;&#x9;    ,[BDSO_CODFISC_VB]+[BDSO_PROGRESS_VB] as chiaveInterna&#xA;&#x9;&#x9;    ,null as chiaveEsterna&#xA;&#x9;&#x9;    ,'Inpdap' as GestoreIndirizzo&#xA;--           &#x9;,AUAAC_IND_QLA_IND_AZ as codiceQualita&#xA;&#x9;&#x9;    ,getdate() as dataModifica&#xA;&#x9;&#x9;    ,'Inpdap' as DescrUtente &#xA;&#x9;&#x9;   ,3 as Aurea --Pubblici&#xA;&#x9; from [dbo].BDSO_SOCIETA_CL&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and BDSO_AUC_PRESENTE_AUPOC &gt;= 1 and bdso_auc_aungi is not null&#xA;&#x9;)&#xA;&#xA;&#xA;&#xA;-- 16 -- Inserimento AUVAS&#xA;&#xA;-- 16.1 -- Inserimento AUVAS stato Aperta (08-03-2017)&#xA;&#xA;&#x9;INSERT INTO [dbo].[tb_auvas_var_stato_pos] (&#xA;&#x9;&#x9;     [auvas_aupoc_codice_pk]&#xA;           &#x9;,[auvas_auspc_codice_pk]&#xA;           &#x9;,[auvas_data_variazione_stato]&#xA;           &#x9;,[auvas_utente]&#xA;           &#x9;,[auvas_dispositivo_utente]&#xA;           &#x9;,[auvas_data_modifica]&#xA;           &#x9;,[auvas_descr_utente] )&#xA;&#x9;(&#xA;&#x9;select&#x9;BDSO_AUC_AUPOC_PK&#xA;&#x9;&#x9;,1 as StatoAperta&#xA;&#x9;&#x9;,[BDSO_DATAINI_VB] as dataVariazioneStato&#xA;&#x9;&#x9;,'-' as Utente&#xA;&#x9;&#x9;,'-' as dispositivo&#xA;&#x9;&#x9;,getdate()&#xA;&#x9;&#x9;,'Inpdap' as DescrUtente&#xA;from BDSO_SOCIETA_CL&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and BDSO_AUC_PRESENTE_AUPOC &gt;= 1 and bdso_auc_aungi is not null&#xA;   &#x9;)&#xA;&#xA;-- 16.2 -- Inserimento AUVAS stato Chiusa Definitiva  (08-03-2017)&#xA;&#xA;&#x9;INSERT INTO [dbo].[tb_auvas_var_stato_pos] (&#xA;&#x9;&#x9;     [auvas_aupoc_codice_pk]&#xA;           &#x9;,[auvas_auspc_codice_pk]&#xA;           &#x9;,[auvas_data_variazione_stato]&#xA;           &#x9;,[auvas_utente]&#xA;           &#x9;,[auvas_dispositivo_utente]&#xA;           &#x9;,[auvas_data_modifica]&#xA;           &#x9;,[auvas_descr_utente] )&#xA;&#x9;(&#xA;&#x9;select&#x9;BDSO_AUC_AUPOC_PK&#xA;&#x9;&#x9;,3 as StatoChiusaDefinitiva&#xA;&#x9;&#x9;,[BDSO_DATAFIN_VB] as dataVariazioneStato&#xA;&#x9;&#x9;,'-' as Utente&#xA;&#x9;&#x9;,'-' as dispositivo&#xA;&#x9;&#x9;,getdate()&#xA;&#x9;&#x9;,'Inpdap' as DescrUtente&#xA;from BDSO_SOCIETA_CL&#xA;  &#x9;where &#x9;BDSO_SOCIETA_CL.BDSO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(BDSO_AUC_AUPOC_PK is not null AND BDSO_AUC_AUPOC_PK &lt;&gt; 0) and BDSO_AUC_PRESENTE_AUPOC &gt;= 1 and bdso_auc_aungi is not null and BDSO_AUC_STATO_POSIZIONE = 3&#xA;   &#x9;)&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- 17 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDSO_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\30_TI_BDSD_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="30_TI_BDSD_02"
      DTS:DTSID="{4fe72cec-c7cf-4060-9b82-523f1c567920}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="30_TI_BDSD_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;SET&#x9;&#x9;BDSD_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdsd (id_bdsd int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdsd (id_bdsd, id_auc) &#xA;&#x9;   SELECT&#x9;BDSD_ID_VA, max(BDSD_AUC_CODICE_PK) FROM BDSD_SEDESOC_CL&#xA;&#x9;   WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDSD_ID_VA&#xA;&#x9;--select * from #temp_bdsd&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDSD_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDSD_SEDESOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdsd ON &#xA;&#x9;&#x9;&#x9;&#x9;BDSD_AUC_CODICE_PK &lt;&gt; #temp_bdsd.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdsd = BDSD_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdsd&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;SET&#x9;&#x9;BDSD_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDSD_SEDESOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSD_SEDESOC_CL ON &#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_ID_VA = TI_BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;&#x9;WHERE&#x9;BDSD_SEDESOC_CL.BDSD_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [BDSD_SEDESOC_CL]&#xA;SET              [BDSD_AUC_CF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [BDSD_SEDESOC_CL] LEFT OUTER JOIN&#xA;                      dbo.TI_BDSO_SOCIETA_CL ON [BDSD_SEDESOC_CL].[BDSD_BDSO_EDI_VR] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([BDSD_SEDESOC_CL].[BDSD_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDSD_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;BDSD_SEDESOC_CL&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 1 and [BDSD_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna vero AUSCA&#xA;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;SET&#x9;&#x9;BDSD_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    BDSD_SEDESOC_CL&#x9;inner join tb_ausca_sog_contr_az on [BDSD_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;BDSD_SEDESOC_CL.BDSD_AUC_STATO_LAVORAZIONE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDSD_ID_VA], [BDSD_AUC_STATO_LAVORAZIONE] = 1 e [BDSD_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDSD_SEDESOC_CL&#xA;   SET&#x9;&#x9;TI_BDSD_SEDESOC_CL.BDSD_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;--&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR&#x9;&#x9;=&#x9;bdse_descriz_vb&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_BDSO_EDI_VR&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_BDSO_EDI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_CODINPS_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_CODINPS_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DATAFINE_VB&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_DATAFINE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DATAINI_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DESCRIZ_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_DESCRIZ_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_UTENTE_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_UTENTE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_BDST_ERI_VR&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_BDST_ERI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DTVAR_VB&#x9;&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_DTVAR_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_AUC_AUSCA_PK&#x9;&#x9;=&#x9;BDSD_SEDESOC_CL.BDSD_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDSD_SEDESOC_CL.BDSD_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    BDSD_SEDESOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSD_SEDESOC_CL ON &#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_ID_VA = TI_BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;&#x9;&#x9;&#x9;inner join BDSE_TIPOSEDE_CT on BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR = BDSE_TIPOSEDE_CT.BDSE_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDSD_ID_VA], [BDSD_AUC_STATO_LAVORAZIONE] = 1 e [BDSD_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDSD_SEDESOC_CL&#xA;           (TI_BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_BDSO_EDI_VR&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_CODINPS_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DATAFINE_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DATAINI_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DESCRIZ_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_MODREC_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_UTENTE_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_BDST_ERI_VR&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DTVAR_VB&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_AUC_AUSCA_PK&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DATA_MODIFICA&#xA;           ,TI_BDSD_SEDESOC_CL.BDSD_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;--&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR&#xA;&#x9;&#x9;  ,bdse_descriz_vb&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_BDSO_EDI_VR&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_CODINPS_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_DATAFINE_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_DATAINI_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_DESCRIZ_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_MODREC_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_UTENTE_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_BDST_ERI_VR&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_DTVAR_VB&#xA;&#x9;&#x9;  ,BDSD_SEDESOC_CL.BDSD_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    BDSD_SEDESOC_CL&#x9;&#x9;&#xA;&#x9;inner join BDSE_TIPOSEDE_CT on BDSD_SEDESOC_CL.BDSD_BDSE_APP_VR = BDSE_TIPOSEDE_CT.BDSE_ID_VA&#xA;--FULL OUTER JOIN&#x9;&#x9;TI_BDSD_SEDESOC_CL ON &#xA;--&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_ID_VA &lt;&gt; TI_BDSD_SEDESOC_CL.BDSD_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSD_SEDESOC_CL.BDSD_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;SET&#x9;&#x9;BDSD_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\31_TI_ANMPG_03"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="31_TI_ANMPG_03"
      DTS:DTSID="{be2ff0e5-6ae3-4be4-a5f0-708b5168c2d8}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="31_TI_ANMPG_03"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="&#xA;-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANMPG_MAILPGIU_CL&#xA;&#x9;SET&#x9;&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anmpg (id_anmpg int, id_anmpg_mail int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anmpg (id_anmpg, id_anmpg_mail, id_auc) &#xA;&#x9;   SELECT&#x9;ANMPG_BDSO_ID_VA_PK, ANMPG_PRG_MAIL_PK, max(ANMPG_AUC_CODICE_PK) FROM TB_ANMPG_MAILPGIU_CL&#xA;&#x9;   WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANMPG_BDSO_ID_VA_PK, ANMPG_PRG_MAIL_PK&#xA;&#x9;--select * from #temp_anmpg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANMPG_MAILPGIU_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANMPG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANMPG_MAILPGIU_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anmpg ON &#xA;&#x9;&#x9;&#x9;&#x9;ANMPG_AUC_CODICE_PK &lt;&gt; #temp_anmpg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anmpg = ANMPG_BDSO_ID_VA_PK and &#xA;&#x9;&#x9;&#x9;&#x9;id_anmpg_mail = ANMPG_PRG_MAIL_PK&#xA;&#x9;&#x9;WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anmpg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANMPG_MAILPGIU_CL&#xA;&#x9;SET&#x9;&#x9;ANMPG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANMPG_MAILPGIU_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANMPG_MAILPGIU_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK = TI_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK = TI_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#xA;&#x9;WHERE&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANMPG_MAILPGIU_CL]&#xA;SET              [ANMPG_AUC_CF_PK] = dbo.TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         dbo.[TB_ANMPG_MAILPGIU_CL] LEFT OUTER JOIN&#xA;                      dbo.TI_BDSO_SOCIETA_CL ON dbo.[TB_ANMPG_MAILPGIU_CL].[ANMPG_BDSO_ID_VA_PK] = dbo.TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     (dbo.[TB_ANMPG_MAILPGIU_CL].[ANMPG_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;--select count(*)&#xA;--FROM         dbo.[TB_ANMPG_MAILPGIU_CL] LEFT OUTER JOIN&#xA;--                      dbo.TI_BDSO_SOCIETA_CL ON dbo.[TB_ANMPG_MAILPGIU_CL].[ANMPG_BDSO_ID_VA_PK] = dbo.TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;--WHERE     (dbo.[TB_ANMPG_MAILPGIU_CL].[ANMPG_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANMPG_MAILPGIU_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;ANMPG_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANMPG_MAILPGIU_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 1 and [ANMPG_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna vero AUSCA&#xA;UPDATE&#x9;[TB_ANMPG_MAILPGIU_CL]&#xA;&#x9;SET&#x9;&#x9;ANMPG_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANMPG_MAILPGIU_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANMPG_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANMPG_MAILPGIU_CL].ANMPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANMPG_BDSO_ID_VA_PK], [ANMPG_PRG_MAIL_PK], [ANMPG_AUC_STATO_LAVORAZIONE] = 1 e [ANMPG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANMPG_MAILPGIU_CL&#xA;   SET&#x9;&#x9;TI_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_INIZ&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_INIZ&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_FINE&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_FINE&#xA;--&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT&#x9;=&#x9;TB_ANTCO_TCONTATT_CT.ANTCO_DESCR_TIPOCONTATTO&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_MAIL_PERSGIU&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_MAIL_PERSGIU&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_COD_UTENTE&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_AGGIORN&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_COD_APPL&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_SISTEMA&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_FLAG_PEC&#x9;&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_FLAG_PEC&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#x9;&#x9;=&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANMPG_MAILPGIU_CL.ANMPG_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANMPG_MAILPGIU_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANMPG_MAILPGIU_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK = TI_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK = TI_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#xA;&#x9;&#x9;&#x9;inner join TB_ANTCO_TCONTATT_CT on TB_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT = TB_ANTCO_TCONTATT_CT.ANTCO_COD_TCONTATT_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANMPG_BDSO_ID_VA_PK], [ANMPG_PRG_MAIL_PK], [ANMPG_AUC_STATO_LAVORAZIONE] = 1 e [ANMPG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANMPG_MAILPGIU_CL&#xA;           (TI_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_INIZ&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_FINE&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_MAIL_PERSGIU&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_COD_UTENTE&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_AGGIORN&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_COD_APPL&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_SISTEMA&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_FLAG_PEC&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DATA_MODIFICA&#xA;           ,TI_ANMPG_MAILPGIU_CL.ANMPG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_INIZ&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_FINE&#xA;--&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT&#xA;&#x9;&#x9;  ,TB_ANTCO_TCONTATT_CT.ANTCO_DESCR_TIPOCONTATTO&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_MAIL_PERSGIU&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_FLAG_PEC&#xA;&#x9;&#x9;  ,TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANMPG_MAILPGIU_CL&#xA;&#x9;inner join TB_ANTCO_TCONTATT_CT on TB_ANMPG_MAILPGIU_CL.ANMPG_ANTCO_COD_TCONTATT = TB_ANTCO_TCONTATT_CT.ANTCO_COD_TCONTATT_PK&#xA;--FULL OUTER JOIN&#x9;&#x9;TI_ANMPG_MAILPGIU_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK &lt;&gt; TI_ANMPG_MAILPGIU_CL.ANMPG_BDSO_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK &lt;&gt; TI_ANMPG_MAILPGIU_CL.ANMPG_PRG_MAIL_PK &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;-- 6 -- Aggiornamento PEC AUSCA se il record target è certificato&#xA;UPDATE  tb_ausca_sog_contr_az&#xA;set&#x9;&#x9;ausca_pec = [ANMPG_MAIL_PERSGIU]&#xA;--select count(*)&#xA;FROM            tb_ausca_sog_contr_az INNER JOIN&#xA;                         TB_ANMPG_MAILPGIU_CL ON tb_ausca_sog_contr_az.ausca_codice_pk = TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;  &#x9;where &#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(ANMPG_AUC_AUSCA_PK is NOT null AND ANMPG_AUC_AUSCA_PK &lt;&gt; 0) &#xA;&#x9;&#x9;&#x9;AND [ausca_soggetto_certificato] = 'S' and [ausca_cert_auten_cod_pk] = 2 and [ausca_cert_cod_entita_rif] = 2&#xA;AND anmpg_flag_pec = 'S' and getdate() &gt;= anmpg_data_iniz and getdate()&lt;=anmpg_data_fine&#xA;&#xA;-- 6.1 -- Inserimento record su AUVAR&#xA;&#x9;DECLARE CURSORE_AUVAR Cursor&#xA;&#x9;FOR&#xA;select ausca_codice_pk&#xA;FROM            tb_ausca_sog_contr_az INNER JOIN&#xA;                         TB_ANMPG_MAILPGIU_CL ON tb_ausca_sog_contr_az.ausca_codice_pk = TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;  &#x9;where &#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(ANMPG_AUC_AUSCA_PK is NOT null AND ANMPG_AUC_AUSCA_PK &lt;&gt; 0) &#xA;&#x9;&#x9;&#x9;AND [ausca_soggetto_certificato] = 'S' and [ausca_cert_auten_cod_pk] = 2 and [ausca_cert_cod_entita_rif] = 2&#xA;AND anmpg_flag_pec = 'S' and getdate() &gt;= anmpg_data_iniz and getdate()&lt;=anmpg_data_fine&#x9;   &#xA;     &#x9;OPEN CURSORE_AUVAR &#xA;      &#xA;    &#x9;Declare @codice_pk int &#xA;    &#x9;FETCH NEXT FROM CURSORE_AUVAR INTO @Codice_pk&#xA;&#x9;&#x9;WHILE (@@FETCH_STATUS = 0)&#x9;&#x9;&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;EXEC AZ_1_SINCRONIZZA @Codice_pk, '3', '1';&#x9;&#xA;&#xA;&#x9;&#x9;FETCH NEXT FROM CURSORE_AUVAR INTO @Codice_pk&#xA;&#x9;END&#xA;&#x9;CLOSE CURSORE_AUVAR&#xA;&#x9;DEALLOCATE CURSORE_AUVAR&#xA;&#xA;-- 7 -- Aggiornamento PEC SIN AUSCA indipendentemente dalla certificazione&#xA;UPDATE  tb_ausca_sog_contr_az&#xA;set&#x9;&#x9;ausca_pec_sin = [ANMPG_MAIL_PERSGIU]&#xA;--select ausca_codice_fiscale&#xA;FROM            tb_ausca_sog_contr_az INNER JOIN&#xA;                         TB_ANMPG_MAILPGIU_CL ON tb_ausca_sog_contr_az.ausca_codice_pk = TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;  &#x9;where &#x9;TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;(ANMPG_AUC_AUSCA_PK is NOT null AND ANMPG_AUC_AUSCA_PK &lt;&gt; 0) &#xA;AND anmpg_flag_pec = 'S' and getdate() &gt;= anmpg_data_iniz and getdate()&lt;=anmpg_data_fine&#xA;&#xA;&#xA;-- 8 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANMPG_MAILPGIU_CL&#xA;&#x9;SET&#x9;&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\32_TI_ANLPG_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="32_TI_ANLPG_02"
      DTS:DTSID="{832a3342-6f4c-429b-830e-98a4388bd26c}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="32_TI_ANLPG_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anlpg (id_anlpg_bdso_rld int, id_anlpg_bdso_rla int, id_anlpg_antlp int, data_ini varchar(50) null, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anlpg (id_anlpg_bdso_rld, id_anlpg_bdso_rla, id_anlpg_antlp, data_ini, id_auc) &#xA;&#x9;   SELECT&#x9;ANLPG_BDSO_ID_VA_RLD_PK, ANLPG_BDSO_ID_VA_RLA_PK, ANLPG_ANTLP_COD_TIPLEGAMEPG_PK, ANLPG_DATA_INIZ_PK, max(ANLPG_AUC_CODICE_PK) FROM TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;   WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANLPG_BDSO_ID_VA_RLD_PK, ANLPG_BDSO_ID_VA_RLA_PK, ANLPG_ANTLP_COD_TIPLEGAMEPG_PK, ANLPG_DATA_INIZ_PK&#xA;&#x9;--select * from #temp_anlpg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANLPG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANLPG_LEGAMIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anlpg ON &#xA;&#x9;&#x9;&#x9;&#x9;ANLPG_AUC_CODICE_PK &lt;&gt; #temp_anlpg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anlpg_bdso_rld = ANLPG_BDSO_ID_VA_RLD_PK and&#xA;&#x9;&#x9;&#x9;&#x9;id_anlpg_bdso_rla = ANLPG_BDSO_ID_VA_RLA_PK and&#xA;&#x9;&#x9;&#x9;&#x9;id_anlpg_antlp = ANLPG_ANTLP_COD_TIPLEGAMEPG_PK and&#xA;&#x9;&#x9;&#x9;&#x9;data_ini = ANLPG_DATA_INIZ_PK&#xA;&#x9;&#x9;WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anlpg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANLPG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANLPG_LEGAMIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANLPG_LEGAMIPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANLPG_LEGAMIPG_CL]&#xA;SET              [ANLPG_AUC_CF_RLD_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANLPG_LEGAMIPG_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANLPG_LEGAMIPG_CL].[ANLPG_BDSO_ID_VA_RLD_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE    ([TB_ANLPG_LEGAMIPG_CL].ANLPG_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA;UPDATE    [TB_ANLPG_LEGAMIPG_CL]&#xA;SET              [ANLPG_AUC_CF_RLA_PK] = dbo.TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANLPG_LEGAMIPG_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANLPG_LEGAMIPG_CL].[ANLPG_BDSO_ID_VA_RLA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE    ([TB_ANLPG_LEGAMIPG_CL].ANLPG_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANLPG_LEGAMIPG_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;ANLPG_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANLPG_LEGAMIPG_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 1 and ([ANLPG_AUC_CF_RLD_PK] is null or [ANLPG_AUC_CF_RLA_PK] is null)&#xA;&#xA;-- 3.3 -- Valorizza le chiavi esterne verso AUSCA&#xA;UPDATE&#x9;[TB_ANLPG_LEGAMIPG_CL]&#xA;&#x9;SET&#x9;&#x9;[ANLPG_AUC_AUSCA_RLD_PK] = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANLPG_LEGAMIPG_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANLPG_AUC_CF_RLD_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANLPG_LEGAMIPG_CL].ANLPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;UPDATE&#x9;[TB_ANLPG_LEGAMIPG_CL]&#xA;&#x9;SET&#x9;&#x9;[ANLPG_AUC_AUSCA_RLA_PK] = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANLPG_LEGAMIPG_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANLPG_AUC_CF_RLA_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANLPG_LEGAMIPG_CL].ANLPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANLPG_BDSO_ID_VA_RLD_PK], [ANLPG_BDSO_ID_VA_RLA_PK], [ANLPG_ANTLP_COD_TIPLEGAMEPG_PK], [ANLPG_DATA_INIZ_PK], [ANLPG_AUC_STATO_LAVORAZIONE] = 1 e [ANLPG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANLPG_LEGAMIPG_CL&#xA;   SET&#x9;&#x9;TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_FINE&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_COD_UTENTE&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_AGGIORN&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_COD_APPL&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_SISTEMA&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLD_PK&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLD_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_MODIFICA&#x9;&#x9;&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANLPG_LEGAMIPG_CL.ANLPG_DESCR_UTENTE&#x9;&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANLPG_LEGAMIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANLPG_LEGAMIPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK = TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANLPG_BDSO_ID_VA_RLD_PK], [ANLPG_BDSO_ID_VA_RLA_PK], [ANLPG_ANTLP_COD_TIPLEGAMEPG_PK], [ANLPG_DATA_INIZ_PK], [ANLPG_AUC_STATO_LAVORAZIONE] = 1 e [ANLPG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANLPG_LEGAMIPG_CL&#xA;           (TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_FINE&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_COD_UTENTE&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_AGGIORN&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_COD_APPL&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_SISTEMA&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLD_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLA_PK&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_MODIFICA&#xA;           ,TI_ANLPG_LEGAMIPG_CL.ANLPG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLD_PK&#xA;          ,TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_AUSCA_RLA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANLPG_LEGAMIPG_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANLPG_LEGAMIPG_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK &lt;&gt; TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLD_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK &lt;&gt; TI_ANLPG_LEGAMIPG_CL.ANLPG_BDSO_ID_VA_RLA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK &lt;&gt; TI_ANLPG_LEGAMIPG_CL.ANLPG_ANTLP_COD_TIPLEGAMEPG_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK &lt;&gt; TI_ANLPG_LEGAMIPG_CL.ANLPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANLPG_LEGAMIPG_CL.ANLPG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\36_TI_BDSV_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="36_TI_BDSV_02"
      DTS:DTSID="{1f8c3ee1-f899-495d-afce-11dd1ed7a603}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="36_TI_BDSV_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDSV_SOCVER_CL&#xA;&#x9;SET&#x9;&#x9;BDSV_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDSV_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdsv (id_bdsv int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdsv (id_bdsv, id_auc) &#xA;&#x9;   SELECT&#x9;BDSV_ID_VA, max(BDSV_AUC_CODICE_PK) FROM BDSV_SOCVER_CL&#xA;&#x9;   WHERE&#x9;BDSV_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDSV_ID_VA&#xA;&#x9;--select * from #temp_bdsv&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDSV_SOCVER_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDSV_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDSV_SOCVER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdsv ON &#xA;&#x9;&#x9;&#x9;&#x9;BDSV_AUC_CODICE_PK &lt;&gt; #temp_bdsv.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_bdsv = BDSV_ID_VA &#xA;&#x9;&#x9;WHERE&#x9;BDSV_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdsv&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDSV_SOCVER_CL&#xA;&#x9;SET&#x9;&#x9;BDSV_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDSV_SOCVER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSV_SOCVER_CL ON &#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_ID_VA = TI_BDSV_SOCVER_CL.BDSV_ID_VA &#xA;&#x9;WHERE&#x9;BDSV_SOCVER_CL.BDSV_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [BDSV_SOCVER_CL]&#xA;SET              [BDSV_AUC_CF_APP_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [BDSV_SOCVER_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [BDSV_SOCVER_CL].[BDSV_BDSO_APP_VR] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([BDSV_SOCVER_CL].[BDSV_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;UPDATE    [BDSV_SOCVER_CL]&#xA;SET              [BDSV_AUC_CF_VER_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [BDSV_SOCVER_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [BDSV_SOCVER_CL].[BDSV_BDSO_VER_VR] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([BDSV_SOCVER_CL].[BDSV_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[BDSV_SOCVER_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;[BDSV_AUC_STATO_LAVORAZIONE] = -2&#xA;&#x9;&#x9;FROM&#x9;[BDSV_SOCVER_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;[BDSV_AUC_STATO_LAVORAZIONE] = 1 and ([BDSV_AUC_CF_APP_PK] is null or [BDSV_AUC_CF_VER_PK] is null)&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[BDSV_SOCVER_CL]&#xA;&#x9;SET&#x9;&#x9;[BDSV_AUC_AUSCA_APP_PK]= AUSCA_CODICE_PK&#xA;&#x9;FROM    [BDSV_SOCVER_CL]&#x9;inner join tb_ausca_sog_contr_az on [BDSV_AUC_CF_APP_PK]= AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[BDSV_SOCVER_CL].[BDSV_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;UPDATE&#x9;[BDSV_SOCVER_CL]&#xA;&#x9;SET&#x9;&#x9;[BDSV_AUC_AUSCA_VER_PK]= AUSCA_CODICE_PK&#xA;&#x9;FROM    [BDSV_SOCVER_CL]&#x9;inner join tb_ausca_sog_contr_az on [BDSV_AUC_CF_VER_PK]= AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[BDSV_SOCVER_CL].[BDSV_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDSV_ID_VA], [BDSV_AUC_STATO_LAVORAZIONE] = 1 e [BDSV_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDSV_SOCVER_CL&#xA;   SET&#x9;&#x9;TI_BDSV_SOCVER_CL.BDSV_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_BDSO_APP_VR&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_BDSO_APP_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_BDSO_VER_VR&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_BDSO_VER_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_DATAFIN_VB&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_DATAFIN_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_DATAINI_VB&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_ECTO_PER_VR&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_ECTO_PER_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_UTENTE_VB&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_UTENTE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_BDST_ERI_VR&#x9;&#x9;&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_BDST_ERI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_AUC_AUSCA_APP_PK&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_AUC_AUSCA_APP_PK&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_AUC_AUSCA_VER_PK&#x9;=&#x9;BDSV_SOCVER_CL.BDSV_AUC_AUSCA_VER_PK&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDSV_SOCVER_CL.BDSV_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    BDSV_SOCVER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDSV_SOCVER_CL ON &#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_ID_VA = TI_BDSV_SOCVER_CL.BDSV_ID_VA &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDSV_ID_VA], [BDSV_AUC_STATO_LAVORAZIONE] = 1 e [BDSV_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDSV_SOCVER_CL&#xA;           (TI_BDSV_SOCVER_CL.BDSV_ID_VA&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_BDSO_APP_VR&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_BDSO_VER_VR&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_DATAFIN_VB&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_DATAINI_VB&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_ECTO_PER_VR&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_MODREC_VB&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_UTENTE_VB&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_BDST_ERI_VR&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_AUC_AUSCA_APP_PK&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_AUC_AUSCA_VER_PK&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_DATA_MODIFICA&#xA;           ,TI_BDSV_SOCVER_CL.BDSV_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDSV_SOCVER_CL.BDSV_ID_VA&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_BDSO_APP_VR&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_BDSO_VER_VR&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_DATAFIN_VB&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_DATAINI_VB&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_ECTO_PER_VR&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_MODREC_VB&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_UTENTE_VB&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_BDST_ERI_VR&#xA;&#x9;&#x9;  ,BDSV_SOCVER_CL.BDSV_AUC_AUSCA_APP_PK&#xA;          ,BDSV_SOCVER_CL.BDSV_AUC_AUSCA_VER_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    BDSV_SOCVER_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDSV_SOCVER_CL ON &#xA;--&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_ID_VA &lt;&gt; TI_BDSV_SOCVER_CL.BDSV_ID_VA &#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDSV_SOCVER_CL.BDSV_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDSV_SOCVER_CL&#xA;&#x9;SET&#x9;&#x9;BDSV_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDSV_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\37_TI_ANCOT_04"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="37_TI_ANCOT_04"
      DTS:DTSID="{8cb902b2-a3ab-483f-8572-53cd8b21964c}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="37_TI_ANCOT_04"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANCOT_COMPTERR_CL&#xA;&#x9;SET&#x9;&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_ancot (id_ancot_bdso int, id_ancot_antct varchar(50), id_ancot_bdlc int, data_ini varchar(50) null, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_ancot (id_ancot_bdso, id_ancot_antct, id_ancot_bdlc, data_ini, id_auc) &#xA;&#x9;   SELECT&#x9;ANCOT_BDSO_ID_VA_PK, ANCOT_ANTCT_COD_TIPCOMTER_PK, ANCOT_BDLC_ID_VA_PK, ANCOT_DATA_INIZ_PK, max(ANCOT_AUC_CODICE_PK) FROM TB_ANCOT_COMPTERR_CL&#xA;&#x9;   WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANCOT_BDSO_ID_VA_PK, ANCOT_ANTCT_COD_TIPCOMTER_PK, ANCOT_BDLC_ID_VA_PK, ANCOT_DATA_INIZ_PK&#xA;&#x9;--select * from #temp_ancot&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANCOT_COMPTERR_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANCOT_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANCOT_COMPTERR_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_ancot ON &#xA;&#x9;&#x9;&#x9;&#x9;ANCOT_AUC_CODICE_PK &lt;&gt; #temp_ancot.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_ancot_bdso = ANCOT_BDSO_ID_VA_PK and &#xA;&#x9;&#x9;&#x9;&#x9;id_ancot_antct = ANCOT_ANTCT_COD_TIPCOMTER_PK and&#xA;&#x9;&#x9;&#x9;&#x9;id_ancot_bdlc = ANCOT_BDLC_ID_VA_PK and&#xA;&#x9;&#x9;&#x9;&#x9;data_ini = ANCOT_DATA_INIZ_PK&#xA;&#x9;&#x9;WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_ancot&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANCOT_COMPTERR_CL&#xA;&#x9;SET&#x9;&#x9;ANCOT_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANCOT_COMPTERR_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANCOT_COMPTERR_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK = TI_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK = TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK = TI_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK = TI_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;&#x9;WHERE&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANCOT_COMPTERR_CL]&#xA;SET              ANCOT_AUC_CF_PK = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANCOT_COMPTERR_CL] LEFT OUTER JOIN&#xA;                      dbo.TI_BDSO_SOCIETA_CL ON [TB_ANCOT_COMPTERR_CL].[ANCOT_BDSO_ID_VA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([TB_ANCOT_COMPTERR_CL].ANCOT_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANCOT_COMPTERR_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;ANCOT_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANCOT_COMPTERR_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 1 and ANCOT_AUC_CF_PK is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[TB_ANCOT_COMPTERR_CL]&#xA;&#x9;SET&#x9;&#x9;ANCOT_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANCOT_COMPTERR_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANCOT_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANCOT_COMPTERR_CL].ANCOT_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANCOT_BDSO_ID_VA_PK], [ANCOT_ANTCT_COD_TIPCOMTER_PK], [ANCOT_BDLC_ID_VA_PK], [ANCOT_DATA_INIZ_PK], [ANCOT_AUC_STATO_LAVORAZIONE] = 1 e [ANCOT_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANCOT_COMPTERR_CL&#xA;   SET&#x9;&#x9;TI_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK&#xA;--&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#x9;=&#x9;TB_ANTCT_TIPCOMTER_CT.ANTCT_DESCR_TIPCOMTER&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_FINE&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_COD_UTENTE&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_AGGIORN&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_COD_APPL&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_SISTEMA&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_AUC_AUSCA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_MODIFICA&#x9;&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANCOT_COMPTERR_CL.ANCOT_DESCR_UTENTE&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANCOT_COMPTERR_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANCOT_COMPTERR_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK = TI_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK = TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK = TI_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK = TI_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;inner join TB_ANTCT_TIPCOMTER_CT on TB_ANTCT_TIPCOMTER_CT.ANTCT_COD_TIPCOMTER_PK = TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANCOT_BDSO_ID_VA_PK], [ANCOT_ANTCT_COD_TIPCOMTER_PK], [ANCOT_BDLC_ID_VA_PK], [ANCOT_DATA_INIZ_PK], [ANCOT_AUC_STATO_LAVORAZIONE] = 1 e [ANCOT_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANCOT_COMPTERR_CL&#xA;           (TI_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_FINE&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_COD_UTENTE&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_AGGIORN&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_COD_APPL&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_SISTEMA&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_AUC_AUSCA_PK&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DATA_MODIFICA&#xA;           ,TI_ANCOT_COMPTERR_CL.ANCOT_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK&#xA;--&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#xA;&#x9;&#x9;  ,TB_ANTCT_TIPCOMTER_CT.ANTCT_DESCR_TIPCOMTER&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANCOT_COMPTERR_CL.ANCOT_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANCOT_COMPTERR_CL&#xA;&#x9;&#x9;&#x9;inner join TB_ANTCT_TIPCOMTER_CT on TB_ANTCT_TIPCOMTER_CT.ANTCT_COD_TIPCOMTER_PK = TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK&#xA; &#x9;&#xA;&#xA;--FULL OUTER JOIN&#x9;&#x9;TI_ANCOT_COMPTERR_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK &lt;&gt; TI_ANCOT_COMPTERR_CL.ANCOT_BDSO_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK &lt;&gt; TI_ANCOT_COMPTERR_CL.ANCOT_ANTCT_COD_TIPCOMTER_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK &lt;&gt; TI_ANCOT_COMPTERR_CL.ANCOT_BDLC_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK &lt;&gt; TI_ANCOT_COMPTERR_CL.ANCOT_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANCOT_COMPTERR_CL.ANCOT_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANCOT_COMPTERR_CL&#xA;&#x9;SET&#x9;&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\40_TI_ANRPG_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="40_TI_ANRPG_02"
      DTS:DTSID="{6b7dc20d-6025-4b08-b072-f9f3108ef3ed}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="40_TI_ANRPG_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANRPG_RUOLIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anrpg (id_anrpg_bdso int, id_anrpg_antrl int, data_ini varchar(50) null, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anrpg (id_anrpg_bdso, id_anrpg_antrl, data_ini, id_auc) &#xA;&#x9;   SELECT&#x9;ANRPG_BDSO_ID_VA_PK, ANRPG_ANTRL_COD_TIPRUOLOPG_PK, ANRPG_DATA_INIZ_PK, max(ANRPG_AUC_CODICE_PK) FROM TB_ANRPG_RUOLIPG_CL&#xA;&#x9;   WHERE&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANRPG_BDSO_ID_VA_PK, ANRPG_ANTRL_COD_TIPRUOLOPG_PK, ANRPG_DATA_INIZ_PK&#xA;&#x9;--select * from #temp_anrpg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANRPG_RUOLIPG_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANRPG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANRPG_RUOLIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anrpg ON &#xA;&#x9;&#x9;&#x9;&#x9;ANRPG_AUC_CODICE_PK &lt;&gt; #temp_anrpg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anrpg_bdso = ANRPG_BDSO_ID_VA_PK and&#xA;&#x9;&#x9;&#x9;&#x9;id_anrpg_antrl = ANRPG_ANTRL_COD_TIPRUOLOPG_PK and&#xA;&#x9;&#x9;&#x9;&#x9;data_ini = ANRPG_DATA_INIZ_PK&#xA;&#x9;&#x9;WHERE&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anrpg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANRPG_RUOLIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANRPG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANRPG_RUOLIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANRPG_RUOLIPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANRPG_RUOLIPG_CL]&#xA;SET              [ANRPG_AUC_CF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANRPG_RUOLIPG_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANRPG_RUOLIPG_CL].[ANRPG_BDSO_ID_VA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([TB_ANRPG_RUOLIPG_CL].[ANRPG_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANRPG_RUOLIPG_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;[ANRPG_AUC_STATO_LAVORAZIONE] = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANRPG_RUOLIPG_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;[ANRPG_AUC_STATO_LAVORAZIONE] = 1 and [ANRPG_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[TB_ANRPG_RUOLIPG_CL]&#xA;&#x9;SET&#x9;&#x9;ANRPG_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANRPG_RUOLIPG_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANRPG_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANRPG_RUOLIPG_CL].[ANRPG_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANRPG_BDSO_ID_VA_PK], [ANRPG_ANTRL_COD_TIPRUOLOPG_PK],  [ANRPG_DATA_INIZ_PK], [ANRPG_AUC_STATO_LAVORAZIONE] = 1 e [ANRPG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANRPG_RUOLIPG_CL&#xA;   SET&#x9;&#x9;TI_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_FINE&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_COD_UTENTE&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_AGGIORN&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_COD_APPL&#x9;&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_SISTEMA&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_ANMCR_COD_MOTCHIRUPG&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_ANMCR_COD_MOTCHIRUPG&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_AUC_AUSCA_PK&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_MODIFICA&#x9;&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANRPG_RUOLIPG_CL.ANRPG_DESCR_UTENTE&#x9;&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANRPG_RUOLIPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANRPG_RUOLIPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK = TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANRPG_BDSO_ID_VA_PK], [ANRPG_ANTRL_COD_TIPRUOLOPG_PK],  [ANRPG_DATA_INIZ_PK], [ANRPG_AUC_STATO_LAVORAZIONE] = 1 e [ANRPG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANRPG_RUOLIPG_CL&#xA;           (TI_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_FINE&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_COD_UTENTE&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_AGGIORN&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_COD_APPL&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_SISTEMA&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_ANMCR_COD_MOTCHIRUPG&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_AUC_AUSCA_PK&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_MODIFICA&#xA;           ,TI_ANRPG_RUOLIPG_CL.ANRPG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_ANMCR_COD_MOTCHIRUPG&#xA;&#x9;&#x9;  ,TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANRPG_RUOLIPG_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANRPG_RUOLIPG_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK &lt;&gt; TI_ANRPG_RUOLIPG_CL.ANRPG_BDSO_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK &lt;&gt; TI_ANRPG_RUOLIPG_CL.ANRPG_ANTRL_COD_TIPRUOLOPG_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK &lt;&gt; TI_ANRPG_RUOLIPG_CL.ANRPG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANRPG_RUOLIPG_CL.ANRPG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANRPG_RUOLIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\41_TI_ANFGG_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="41_TI_ANFGG_02"
      DTS:DTSID="{004a45f0-6e00-4cb7-8199-6558fcdf4af2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="41_TI_ANFGG_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anfgg (id_anfgg int, data_ini varchar(50) null, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anfgg (id_anfgg, data_ini, id_auc) &#xA;&#x9;   SELECT&#x9;ANFGG_BDSO_ID_VA_PK, ANFGG_DATA_INIZ_PK, max(ANFGG_AUC_CODICE_PK) FROM TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;   WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANFGG_BDSO_ID_VA_PK, ANFGG_DATA_INIZ_PK&#xA;&#x9;--select * from #temp_anfgg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANFGG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANFGG_FORMAGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anfgg ON &#xA;&#x9;&#x9;&#x9;&#x9;ANFGG_AUC_CODICE_PK &lt;&gt; #temp_anfgg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anfgg = ANFGG_BDSO_ID_VA_PK and &#xA;&#x9;&#x9;&#x9;&#x9;data_ini = ANFGG_DATA_INIZ_PK&#xA;&#x9;&#x9;WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anfgg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANFGG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANFGG_FORMAGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANFGG_FORMAGIURPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK = TI_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK = TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANFGG_FORMAGIURPG_CL]&#xA;SET              [ANFGG_AUC_CF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANFGG_FORMAGIURPG_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANFGG_FORMAGIURPG_CL].[ANFGG_BDSO_ID_VA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([TB_ANFGG_FORMAGIURPG_CL].ANFGG_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANFGG_FORMAGIURPG_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;ANFGG_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANFGG_FORMAGIURPG_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 1 and [ANFGG_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[TB_ANFGG_FORMAGIURPG_CL]&#xA;&#x9;SET&#x9;&#x9;ANFGG_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANFGG_FORMAGIURPG_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANFGG_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANFGG_FORMAGIURPG_CL].ANFGG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANFGG_BDSO_ID_VA_PK], [ANFGG_DATA_INIZ_PK], [ANFGG_AUC_STATO_LAVORAZIONE] = 1 e [ANFGG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANFGG_FORMAGIURPG_CL&#xA;   SET&#x9;&#x9;TI_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_FINE&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_ANFGI_COD_FORMAGIUR&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_ANFGI_COD_FORMAGIUR&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_COD_UTENTE&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_AGGIORN&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_COD_APPL&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_SISTEMA&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_AUSCA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DESCR_UTENTE&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANFGG_FORMAGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANFGG_FORMAGIURPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK = TI_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK = TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANFGG_BDSO_ID_VA_PK], [ANFGG_DATA_INIZ_PK], [ANFGG_AUC_STATO_LAVORAZIONE] = 1 e [ANFGG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANFGG_FORMAGIURPG_CL&#xA;           (TI_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_FINE&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_ANFGI_COD_FORMAGIUR&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_COD_UTENTE&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_AGGIORN&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_COD_APPL&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_SISTEMA&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_AUSCA_PK&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_MODIFICA&#xA;           ,TI_ANFGG_FORMAGIURPG_CL.ANFGG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_ANFGI_COD_FORMAGIUR&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANFGG_FORMAGIURPG_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANFGG_FORMAGIURPG_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK &lt;&gt; TI_ANFGG_FORMAGIURPG_CL.ANFGG_BDSO_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK &lt;&gt; TI_ANFGG_FORMAGIURPG_CL.ANFGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANFGG_FORMAGIURPG_CL.ANFGG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\42_TI_ANPGO_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="42_TI_ANPGO_02"
      DTS:DTSID="{cfe9acbb-469f-43cf-8a76-1b83f5cad626}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="42_TI_ANPGO_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANPGO_PGOPER_CL&#xA;&#x9;SET&#x9;&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anpgo (id_anpgo_anopg int, id_anpgo_bdso int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anpgo (id_anpgo_anopg, id_anpgo_bdso, id_auc) &#xA;&#x9;   SELECT&#x9;ANPGO_ANOPG_SEQ_OPERAZPG_PK, ANPGO_BDSO_ID_VA_PK, max(ANPGO_AUC_CODICE_PK) FROM TB_ANPGO_PGOPER_CL&#xA;&#x9;   WHERE&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANPGO_ANOPG_SEQ_OPERAZPG_PK, ANPGO_BDSO_ID_VA_PK&#xA;&#x9;--select * from #temp_anpgo&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANPGO_PGOPER_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANPGO_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANPGO_PGOPER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anpgo ON &#xA;&#x9;&#x9;&#x9;&#x9;ANPGO_AUC_CODICE_PK &lt;&gt; #temp_anpgo.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anpgo_anopg = ANPGO_ANOPG_SEQ_OPERAZPG_PK and&#xA;&#x9;&#x9;&#x9;&#x9;id_anpgo_bdso = ANPGO_BDSO_ID_VA_PK&#xA;&#x9;&#x9;WHERE&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anpgo&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANPGO_PGOPER_CL&#xA;&#x9;SET&#x9;&#x9;ANPGO_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANPGO_PGOPER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANPGO_PGOPER_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK = TI_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK = TI_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;&#x9;WHERE&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANPGO_PGOPER_CL]&#xA;SET              [ANPGO_AUC_CF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANPGO_PGOPER_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANPGO_PGOPER_CL].[ANPGO_BDSO_ID_VA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([TB_ANPGO_PGOPER_CL].[ANPGO_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANPGO_PGOPER_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;[ANPGO_AUC_STATO_LAVORAZIONE] = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANPGO_PGOPER_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;[ANPGO_AUC_STATO_LAVORAZIONE] = 1 and [ANPGO_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[TB_ANPGO_PGOPER_CL]&#xA;&#x9;SET&#x9;&#x9;ANPGO_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANPGO_PGOPER_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANPGO_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANPGO_PGOPER_CL].[ANPGO_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANPGO_ANOPG_SEQ_OPERAZPG_PK], [ANPGO_BDSO_ID_VA_PK], [ANPGO_AUC_STATO_LAVORAZIONE] = 1 e [ANPGO_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANPGO_PGOPER_CL&#xA;   SET&#x9;&#x9;TI_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_FLAG_TIPOPG&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_FLAG_TIPOPG&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_COD_UTENTE&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_DATA_AGGIORN&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_COD_APPL&#x9;&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_DATA_SISTEMA&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_AUC_AUSCA_PK&#x9;&#x9;&#x9;=&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_DATA_MODIFICA&#x9;&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANPGO_PGOPER_CL.ANPGO_DESCR_UTENTE&#x9;&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANPGO_PGOPER_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANPGO_PGOPER_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK = TI_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK = TI_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANPGO_ANOPG_SEQ_OPERAZPG_PK], [ANPGO_BDSO_ID_VA_PK], [ANPGO_AUC_STATO_LAVORAZIONE] = 1 e [ANPGO_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANPGO_PGOPER_CL&#xA;           (TI_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_FLAG_TIPOPG&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_COD_UTENTE&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_DATA_AGGIORN&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_COD_APPL&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_DATA_SISTEMA&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_AUC_AUSCA_PK&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_DATA_MODIFICA&#xA;           ,TI_ANPGO_PGOPER_CL.ANPGO_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_FLAG_TIPOPG&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANPGO_PGOPER_CL.ANPGO_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANPGO_PGOPER_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANPGO_PGOPER_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK &lt;&gt; TI_ANPGO_PGOPER_CL.ANPGO_ANOPG_SEQ_OPERAZPG_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK &lt;&gt; TI_ANPGO_PGOPER_CL.ANPGO_BDSO_ID_VA_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANPGO_PGOPER_CL.ANPGO_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANPGO_PGOPER_CL&#xA;&#x9;SET&#x9;&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\43_TI_ANNGG_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="43_TI_ANNGG_02"
      DTS:DTSID="{6b0a6ddb-1fdd-4acb-8484-2b454309d1cc}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="43_TI_ANNGG_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;TB_ANNGG_NATGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_anngg (id_anngg int, data_ini varchar(50) null, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_anngg (id_anngg, data_ini, id_auc) &#xA;&#x9;   SELECT&#x9;ANNGG_BDSO_ID_VA_PK, ANNGG_DATA_INIZ_PK, max(ANNGG_AUC_CODICE_PK) FROM TB_ANNGG_NATGIURPG_CL&#xA;&#x9;   WHERE&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;ANNGG_BDSO_ID_VA_PK, ANNGG_DATA_INIZ_PK&#xA;&#x9;--select * from #temp_anngg&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;TB_ANNGG_NATGIURPG_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;ANNGG_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;TB_ANNGG_NATGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_anngg ON &#xA;&#x9;&#x9;&#x9;&#x9;ANNGG_AUC_CODICE_PK &lt;&gt; #temp_anngg.id_auc and &#xA;&#x9;&#x9;&#x9;&#x9;id_anngg = ANNGG_BDSO_ID_VA_PK and&#xA;&#x9;&#x9;&#x9;&#x9;data_ini = ANNGG_DATA_INIZ_PK&#xA;&#x9;&#x9;WHERE&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_anngg&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;TB_ANNGG_NATGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANNGG_AUC_PRESENTE = 1&#xA;&#x9;FROM    TB_ANNGG_NATGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANNGG_NATGIURPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK = TI_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK = TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [TB_ANNGG_NATGIURPG_CL]&#xA;SET              [ANNGG_AUC_CF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [TB_ANNGG_NATGIURPG_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [TB_ANNGG_NATGIURPG_CL].[ANNGG_BDSO_ID_VA_PK] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([TB_ANNGG_NATGIURPG_CL].[ANNGG_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[TB_ANNGG_NATGIURPG_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;[ANNGG_AUC_STATO_LAVORAZIONE] = -2&#xA;&#x9;&#x9;FROM&#x9;[TB_ANNGG_NATGIURPG_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;[ANNGG_AUC_STATO_LAVORAZIONE] = 1 and [ANNGG_AUC_CF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[TB_ANNGG_NATGIURPG_CL]&#xA;&#x9;SET&#x9;&#x9;ANNGG_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    [TB_ANNGG_NATGIURPG_CL]&#x9;inner join tb_ausca_sog_contr_az on [ANNGG_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[TB_ANNGG_NATGIURPG_CL].[ANNGG_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [ANNGG_BDSO_ID_VA_PK], [ANNGG_DATA_INIZ_PK], [ANNGG_AUC_STATO_LAVORAZIONE] = 1 e [ANNGG_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_ANNGG_NATGIURPG_CL&#xA;   SET&#x9;&#x9;TI_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_FINE&#x9;&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_FINE&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_BDNG_ID_VA&#x9;&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_BDNG_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_COD_UTENTE&#x9;&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_COD_UTENTE&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_AGGIORN&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_AGGIORN&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_COD_APPL&#x9;&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_COD_APPL&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_SISTEMA&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_SISTEMA&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_AUC_AUSCA_PK&#x9;=&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_MODIFICA&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_ANNGG_NATGIURPG_CL.ANNGG_DESCR_UTENTE&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM    TB_ANNGG_NATGIURPG_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_ANNGG_NATGIURPG_CL ON &#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK = TI_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK AND&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK = TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [ANNGG_BDSO_ID_VA_PK], [ANNGG_DATA_INIZ_PK], [ANNGG_AUC_STATO_LAVORAZIONE] = 1 e [ANNGG_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_ANNGG_NATGIURPG_CL&#xA;           (TI_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_FINE&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_BDNG_ID_VA&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_COD_UTENTE&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_AGGIORN&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_COD_APPL&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_SISTEMA&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_AUC_AUSCA_PK&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_MODIFICA&#xA;           ,TI_ANNGG_NATGIURPG_CL.ANNGG_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_FINE&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_BDNG_ID_VA&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_COD_UTENTE&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_AGGIORN&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_COD_APPL&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_SISTEMA&#xA;&#x9;&#x9;  ,TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM    TB_ANNGG_NATGIURPG_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_ANNGG_NATGIURPG_CL ON &#xA;--&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK &lt;&gt; TI_ANNGG_NATGIURPG_CL.ANNGG_BDSO_ID_VA_PK AND&#xA;--&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK &lt;&gt; TI_ANNGG_NATGIURPG_CL.ANNGG_DATA_INIZ_PK&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;TB_ANNGG_NATGIURPG_CL.ANNGG_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;TB_ANNGG_NATGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\44_TI_BDRS_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="44_TI_BDRS_02"
      DTS:DTSID="{5082775f-9857-452e-ad58-002bef16a4c0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="44_TI_BDRS_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9;BDRS_STORSOC_CL&#xA;&#x9;SET&#x9;&#x9;BDRS_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDRS_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdrs (id_bdrs int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdrs (id_bdrs, id_auc) &#xA;&#x9;   SELECT&#x9;BDRS_ID_VA, max(BDRS_AUC_CODICE_PK) FROM BDRS_STORSOC_CL&#xA;&#x9;   WHERE&#x9;BDRS_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDRS_ID_VA&#xA;&#x9;--select * from #temp_bdrs&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9;BDRS_STORSOC_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDRS_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9;BDRS_STORSOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdrs ON &#xA;&#x9;&#x9;&#x9;&#x9;BDRS_AUC_CODICE_PK &lt;&gt; #temp_bdrs.id_auc and id_bdrs = BDRS_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDRS_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdrs&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9;BDRS_STORSOC_CL&#xA;&#x9;SET&#x9;&#x9;BDRS_AUC_PRESENTE = 1&#xA;&#x9;FROM    BDRS_STORSOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDRS_STORSOC_CL ON &#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_ID_VA = TI_BDRS_STORSOC_CL.BDRS_ID_VA&#xA;&#x9;WHERE&#x9;BDRS_STORSOC_CL.BDRS_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    [BDRS_STORSOC_CL]&#xA;SET              [BDRS_AUC_CF_RIF_PK] = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         [BDRS_STORSOC_CL] LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON [BDRS_STORSOC_CL].[BDRS_BDSO_RIF_VR] = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     ([BDRS_STORSOC_CL].[BDRS_AUC_STATO_LAVORAZIONE] = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;[BDRS_STORSOC_CL]&#xA;&#x9;&#x9;SET&#x9;&#x9;[BDRS_AUC_STATO_LAVORAZIONE] = -2&#xA;&#x9;&#x9;FROM&#x9;[BDRS_STORSOC_CL]&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;[BDRS_AUC_STATO_LAVORAZIONE] = 1 and [BDRS_AUC_CF_RIF_PK] is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;[BDRS_STORSOC_CL]&#xA;&#x9;SET&#x9;&#x9;[BDRS_AUC_AUSCA_RIF_PK]= AUSCA_CODICE_PK&#xA;&#x9;FROM    [BDRS_STORSOC_CL]&#x9;inner join tb_ausca_sog_contr_az on [BDRS_AUC_CF_RIF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;[BDRS_STORSOC_CL].[BDRS_AUC_STATO_LAVORAZIONE] = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDRS_ID_VA], [BDRS_AUC_STATO_LAVORAZIONE] = 1 e [BDRS_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDRS_STORSOC_CL&#xA;   SET&#x9;&#x9;TI_BDRS_STORSOC_CL.BDRS_ID_VA&#x9;&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_ID_VA&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_BDNG_EDI_VR&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_BDNG_EDI_VR&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_BDSO_RIF_VR&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_BDSO_RIF_VR&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_BDTS_APP_VR&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_BDTS_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_CODFISC_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_CODFISC_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_CONTGESC_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_CONTGESC_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DATAFIN_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_DATAFIN_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DATAINI_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_DATAINI_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DATAVAR_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_DATAVAR_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DENOM_VB&#x9;&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_DENOM_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_PIVA_VB&#x9;&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_PIVA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_MODREC_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_MODREC_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_PROGRESS_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_PROGRESS_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_CERTIF_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_CERTIF_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_FLGOPZ_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_FLGOPZ_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_UTENTE_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_UTENTE_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_BDST_ERI_VR&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_BDST_ERI_VR&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_MAINIDMA_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_MAINIDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_MAFINDMA_VB&#x9;&#x9;= BDRS_STORSOC_CL.BDRS_MAFINDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_EDI_PK&#x9;= BDRS_STORSOC_CL.BDRS_AUC_AUSCA_EDI_PK&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_RIF_PK&#x9;= BDRS_STORSOC_CL.BDRS_AUC_AUSCA_RIF_PK&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_APP_PK&#x9;= BDRS_STORSOC_CL.BDRS_AUC_AUSCA_APP_PK&#x9;&#x9;&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DATA_MODIFICA&#x9;= GetDate()&#xA;&#x9;&#x9;  ,TI_BDRS_STORSOC_CL.BDRS_DESCR_UTENTE&#x9;&#x9;= 'Variazione pubblici'&#xA;&#x9;FROM    BDRS_STORSOC_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDRS_STORSOC_CL ON &#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_ID_VA = TI_BDRS_STORSOC_CL.BDRS_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDRS_ID_VA], [BDRS_AUC_STATO_LAVORAZIONE] = 1 e [BDRS_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDRS_STORSOC_CL&#xA;           (TI_BDRS_STORSOC_CL.BDRS_ID_VA&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_BDNG_EDI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_BDSO_RIF_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_BDTS_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_CODFISC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_CONTGESC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DATAFIN_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DATAINI_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DATAVAR_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DENOM_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_PIVA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_MODREC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_PROGRESS_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_CERTIF_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_FLGOPZ_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_UTENTE_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_BDST_ERI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_MAINIDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_MAFINDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_EDI_PK&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_RIF_PK&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_AUC_AUSCA_APP_PK&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DATA_MODIFICA&#x9;&#xA;&#x9;&#x9;&#x9;,TI_BDRS_STORSOC_CL.BDRS_DESCR_UTENTE)&#xA;&#x9;SELECT &#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_ID_VA&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_BDNG_EDI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_BDSO_RIF_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_BDTS_APP_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_CODFISC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_CONTGESC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_DATAFIN_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_DATAINI_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_DATAVAR_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_DENOM_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_PIVA_VB&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_MODREC_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_PROGRESS_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_CERTIF_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_FLGOPZ_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_UTENTE_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_BDST_ERI_VR&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_MAINIDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_MAFINDMA_VB&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_AUC_AUSCA_EDI_PK&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_AUC_AUSCA_RIF_PK&#xA;&#x9;&#x9;&#x9;,BDRS_STORSOC_CL.BDRS_AUC_AUSCA_APP_PK&#x9;&#xA;&#x9;&#x9;&#x9;,GetDate()&#xA;&#x9;&#x9;&#x9;,'Inserimento pubblici'&#xA;&#x9;FROM    BDRS_STORSOC_CL&#x9;&#x9;--FULL OUTER JOIN&#x9;&#x9;TI_BDRS_STORSOC_CL ON &#xA;--&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_ID_VA &lt;&gt; TI_BDRS_STORSOC_CL.BDRS_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9;BDRS_STORSOC_CL.BDRS_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9;BDRS_STORSOC_CL&#xA;&#x9;SET&#x9;&#x9;BDRS_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDRS_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\45_TI_BDZE_02"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="45_TI_BDZE_02"
      DTS:DTSID="{7dd1aa8f-c07d-4f96-a151-b97b7fb0f5a0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="45_TI_BDZE_02"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="-- 1 -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record  (da 0 a 1)&#xA;UPDATE&#x9; BDZE_ISCRIZEN_CL&#xA;&#x9;SET&#x9;&#x9;BDZE_AUC_STATO_LAVORAZIONE = 1&#xA;&#x9;WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 0&#xA;GO&#xA;&#xA;&#xA;-- 2 -- Creazione di una Tabella temporanea&#xA;&#x9; CREATE TABLE dbo.#temp_bdze (id_bdze int, id_auc int) on [primary];&#xA;&#xA;&#x9; -- 2a -- Inserisco nella Tabella temporanea il record con la chiave AUC maggiore (l'ultimo arrivato, il più recente)&#xA;&#x9;INSERT #temp_bdze (id_bdze, id_auc) &#xA;&#x9;   SELECT&#x9;BDZE_ID_VA, max(BDZE_AUC_CODICE_PK) FROM  BDZE_ISCRIZEN_CL&#xA;&#x9;   WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 1 &#xA;&#x9;   GROUP BY&#x9;BDZE_ID_VA&#xA;&#x9;--select * from #temp_bdze&#xA;&#xA;&#x9;-- 2b -- Aggiorno nella Tabella di Staging il campo Lavorazione per bloccare i record, per non prenderli più (da 1 a -1)&#xA;&#x9;UPDATE&#x9; BDZE_ISCRIZEN_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDZE_AUC_STATO_LAVORAZIONE = -1&#xA;&#x9;&#x9;FROM&#x9; BDZE_ISCRIZEN_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;#temp_bdze ON &#xA;&#x9;&#x9;&#x9;&#x9;BDZE_AUC_CODICE_PK &lt;&gt; #temp_bdze.id_auc and id_bdze = BDZE_ID_VA&#xA;&#x9;&#x9;WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#x9;-- 2c --&#xA;&#x9;  DROP TABLE #temp_bdze&#xA;&#xA;&#xA;-- 3 -- Aggiorno nella Tabella di Staging il campo Presente per utilizzarlo nelle successive query (da 0 a 1)&#xA;UPDATE&#x9; BDZE_ISCRIZEN_CL&#xA;&#x9;SET&#x9;&#x9;BDZE_AUC_PRESENTE = 1&#xA;&#x9;FROM     BDZE_ISCRIZEN_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDZE_ISCRIZEN_CL ON &#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_ID_VA = TI_BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;&#x9;WHERE&#x9; BDZE_ISCRIZEN_CL.BDZE_AUC_STATO_LAVORAZIONE = 1&#xA;GO&#xA;&#xA;-- 3.1 -- Ricavo il codice fiscale &#xA;UPDATE    BDZE_ISCRIZEN_CL&#xA;SET              BDZE_AUC_CF_PK = TI_BDSO_SOCIETA_CL.BDSO_CODFISC_VB&#xA;FROM         BDZE_ISCRIZEN_CL LEFT OUTER JOIN&#xA;                      TI_BDSO_SOCIETA_CL ON BDZE_ISCRIZEN_CL.BDZE_BDSO_EDI_VR = TI_BDSO_SOCIETA_CL.BDSO_ID_VA&#xA;WHERE     (BDZE_ISCRIZEN_CL.BDZE_AUC_STATO_LAVORAZIONE = 1)&#xA;&#xA;-- 3.2 -- Scarta il record se non ha potuto determinare il codice fiscale&#xA;&#x9;UPDATE&#x9;BDZE_ISCRIZEN_CL&#xA;&#x9;&#x9;SET&#x9;&#x9;BDZE_AUC_STATO_LAVORAZIONE = -2&#xA;&#x9;&#x9;FROM&#x9;BDZE_ISCRIZEN_CL&#x9;&#x9;&#xA;&#x9;&#x9;WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 1 and BDZE_AUC_CF_PK is null&#xA;&#xA;-- 3.3 -- Valorizza la chiave esterna verso AUSCA&#xA;UPDATE&#x9;BDZE_ISCRIZEN_CL&#xA;&#x9;SET&#x9;&#x9;BDZE_AUC_AUSCA_PK = AUSCA_CODICE_PK&#xA;&#x9;FROM    BDZE_ISCRIZEN_CL&#x9;inner join tb_ausca_sog_contr_az on [BDZE_AUC_CF_PK] = AUSCA_CODICE_FISCALE&#xA;&#x9;WHERE&#x9;BDZE_ISCRIZEN_CL.BDZE_AUC_STATO_LAVORAZIONE = 1 &#xA;&#xA;&#xA;-- 4 -- Aggiorno nella Tabella Target i record che abbiano lo stesso valore in [BDZE_ID_VA], [BDZE_AUC_STATO_LAVORAZIONE] = 1 e [BDZE_AUC_PRESENTE] = 1&#xA;UPDATE&#x9;TI_BDZE_ISCRIZEN_CL&#xA;   SET&#x9;&#x9;TI_BDZE_ISCRIZEN_CL.BDZE_ID_VA&#x9;&#x9;&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDCS_EDI_VR&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDCS_EDI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDSO_EDI_VR&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDSO_EDI_VR&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_DATAFINE_VB&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_DATAFINE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_DATAINI_VB&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_DATAINI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_DATARICH_VB&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_DATARICH_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_MODREC_VB&#x9;&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_MODREC_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_UTENTE_VB&#x9;&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_UTENTE_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDST_ERI_VR&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDST_ERI_VR&#xA;--&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_ID_VA&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDPI_ID_VA&#xA;--&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_CODTISCR_VB&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDPI_CODTISCR_VB&#xA;--&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_DESCRTI_VB&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_BDPI_DESCRTI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_ID_VA&#x9;&#x9;=&#x9;BDPI_TIPOISCR_CT.BDPI_ID_VA&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_CODTISCR_VB&#x9;=&#x9;BDPI_TIPOISCR_CT.BDPI_CODTISCR_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_DESCRTI_VB&#x9;=&#x9;BDPI_TIPOISCR_CT.BDPI_DESCRTI_VB&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_AUC_AUSCA_PK&#x9;&#x9;=&#x9;BDZE_ISCRIZEN_CL.BDZE_AUC_AUSCA_PK&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_DATA_MODIFICA&#x9;&#x9;=&#x9;GetDate()&#xA;&#x9;&#x9;&#x9;,TI_BDZE_ISCRIZEN_CL.BDZE_DESCR_UTENTE&#x9;&#x9;=&#x9;'Variazione pubblici'&#xA;&#x9;FROM     BDZE_ISCRIZEN_CL&#x9;&#x9;INNER JOIN&#x9;&#x9;TI_BDZE_ISCRIZEN_CL ON &#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_ID_VA = TI_BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;&#x9;&#x9;&#x9; inner join BDPI_TIPOISCR_CT on BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR = BDPI_TIPOISCR_CT.BDPI_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_AUC_PRESENTE = 1 &#xA;GO&#xA;&#xA;&#xA;-- 5 -- Inserisco nella Tabella Target i record che non abbiano lo stesso valore in [BDZE_ID_VA], [BDZE_AUC_STATO_LAVORAZIONE] = 1 e [BDZE_AUC_PRESENTE] = 0 &#xA;INSERT INTO TI_BDZE_ISCRIZEN_CL&#xA;           (TI_BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDCS_EDI_VR&#x9;&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR&#x9;&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDSO_EDI_VR&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_DATAFINE_VB&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_DATAINI_VB&#xA;&#x9;&#x9;   ,TI_BDZE_ISCRIZEN_CL.BDZE_DATARICH_VB&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_MODREC_VB&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_UTENTE_VB&#x9;&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDST_ERI_VR&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_ID_VA&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_CODTISCR_VB&#xA;           ,TI_BDZE_ISCRIZEN_CL.BDZE_BDPI_DESCRTI_VB&#xA;&#x9;&#x9;   ,TI_BDZE_ISCRIZEN_CL.BDZE_AUC_AUSCA_PK&#xA;&#x9;&#x9;   ,TI_BDZE_ISCRIZEN_CL.BDZE_DATA_MODIFICA&#x9;&#xA;&#x9;&#x9;   ,TI_BDZE_ISCRIZEN_CL.BDZE_DESCR_UTENTE)&#xA;&#xA;&#x9;SELECT &#xA;&#x9;&#x9;   BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_BDCS_EDI_VR&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_BDSO_EDI_VR&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_DATAFINE_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_DATAINI_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_DATARICH_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_MODREC_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_UTENTE_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_BDST_ERI_VR&#xA;&#x9;&#x9;  --,BDZE_ISCRIZEN_CL.BDZE_BDPI_ID_VA&#xA;&#x9;&#x9;  --,BDZE_ISCRIZEN_CL.BDZE_BDPI_CODTISCR_VB&#xA;&#x9;&#x9;  --,BDZE_ISCRIZEN_CL.BDZE_BDPI_DESCRTI_VB&#xA;&#x9;&#x9;  ,BDPI_TIPOISCR_CT.BDPI_ID_VA&#xA;&#x9;&#x9;  ,BDPI_TIPOISCR_CT.BDPI_CODTISCR_VB&#xA;&#x9;&#x9;  ,BDPI_TIPOISCR_CT.BDPI_DESCRTI_VB&#xA;&#x9;&#x9;  ,BDZE_ISCRIZEN_CL.BDZE_AUC_AUSCA_PK&#xA;&#x9;&#x9;  ,GetDate()&#xA;&#x9;&#x9;  ,'Inserimento pubblici'&#xA;&#x9;FROM     BDZE_ISCRIZEN_CL&#xA;inner join BDPI_TIPOISCR_CT on BDZE_ISCRIZEN_CL.BDZE_BDPI_EDI_VR = BDPI_TIPOISCR_CT.BDPI_ID_VA&#xA;--FULL OUTER JOIN&#x9;&#x9;TI_BDZE_ISCRIZEN_CL ON &#xA;--&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_ID_VA &lt;&gt; TI_BDZE_ISCRIZEN_CL.BDZE_ID_VA&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_AUC_STATO_LAVORAZIONE = 1  AND&#xA;&#x9;&#x9;&#x9; BDZE_ISCRIZEN_CL.BDZE_AUC_PRESENTE = 0 &#xA;GO&#xA;&#xA;&#xA;-- 6 -- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 1 a 2)&#xA;UPDATE&#x9; BDZE_ISCRIZEN_CL&#xA;&#x9;SET&#x9;&#x9;BDZE_AUC_STATO_LAVORAZIONE = 2&#xA;&#x9;WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 1&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\98_Refresh AUICA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="98_Refresh AUICA"
      DTS:DTSID="{afb71a37-b2de-47ab-8112-de1d1c0e6070}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="98_Refresh AUICA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="Truncate table tb_auica_iscritte_casse&#xA;&#xA;INSERT INTO [dbo].[tb_auica_iscritte_casse]&#xA;           ([auica_aupoc_codice_pk]&#xA;           ,[auica_id_sin]&#xA;           ,[auica_codice_fiscale]&#xA;           ,[auica_progressivo_confluito]&#xA;           ,[auica_cassa]&#xA;           ,[auica_data_inizio]&#xA;           ,[auica_data_fine]&#xA;           ,[auica_data_modifica]&#xA;           ,[auica_descr_utente]&#xA;           ,[auica_aucas_codice_pk]&#xA;           ,[auica_rec_del]&#xA;           ,[auica_data_del]&#xA;           ,[auica_tipo_iscr_INPDAP]&#xA;           ,[auica_desc_tipo_iscr_INPDAP])&#xA;  select aupoc_codice_pk as [auica_aupoc_codice_pk]&#xA;  ,bdso_id_va as [auica_id_sin]&#xA;  ,[BDSO_CODFISC_VB] as [auica_codice_fiscale]&#xA;  ,[BDSO_PROGRESS_VB] as [auica_progressivo_confluito]&#xA;  ,aucas_codice as [auica_cassa]&#xA;  ,[BDZE_DATAINI_VB] as [auica_data_inizio]&#xA;  ,[BDZE_DATAFINE_VB] as [auica_data_fine]&#xA;  ,getdate() as [auica_data_modifica]&#xA;  ,'Agg. SIN' as [auica_descr_utente]&#xA;  ,[aucas_codice_pk] as [auica_aucas_codice_pk]&#xA;  ,null as [auica_rec_del]&#xA;  ,null as [auica_data_del]&#xA;  ,substring([BDZE_BDPI_CODTISCR_VB],1,1) as [auica_tipo_iscr_INPDAP]&#xA;  ,substring([BDZE_BDPI_DESCRTI_VB],1,20) as [auica_desc_tipo_iscr_INPDAP]&#xA;  FROM [AUC].[dbo].[TI_BDZE_ISCRIZEN_CL]&#xA;  inner join tb_ausca_sog_contr_az on ausca_codice_pk = [BDZE_AUC_AUSCA_PK]&#xA;  inner join ti_bdso_societa_cl on bdso_id_va = BDZE_BDSO_EDI_VR&#xA;  inner join tb_aupoc_pos_contr on [BDSO_CODFISC_VB]+[BDSO_PROGRESS_VB] = aupoc_posizione&#xA;  inner join tb_aucas_casse_inpdap on [BDZE_BDCS_EDI_VR]=[AUCAS_BDCS_ID_VA]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\99_UPDATE FINALE"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="99_UPDATE FINALE"
      DTS:DTSID="{e5bf3913-ab04-4bde-baec-8d74bd826f34}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="99_UPDATE FINALE"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--- UPDATE FINALE&#xA;&#xA;-- Aggiorno nella Tabella di Staging il campo Lavorazione per non lavorare più quei record  (da 2 a 3)&#xA;&#xA;--1&#xA;UPDATE&#x9;TB_ANTOG_TOPERPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANTOG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--2&#xA;UPDATE&#x9; BDRG_RGNATGIU_CT&#xA;&#x9;SET&#x9;&#x9;BDRG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDRG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--3&#xA;UPDATE&#x9;[BDCS_CASSA_CL]&#xA;&#x9;SET&#x9;&#x9;BDCS_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDCS_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--4&#xA;UPDATE&#x9;TB_ANTRL_TIPRUOLOPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANTRL_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--5&#xA;UPDATE&#x9;TB_ANTLP_TIPLEGAMEPG_CT&#xA;&#x9;SET&#x9;&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANTLP_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--6&#xA;UPDATE&#x9;TB_ANFGI_FORMAGIU_CT&#xA;&#x9;SET&#x9;&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANFGI_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--7&#xA;UPDATE&#x9;BDTS_TIPOSOC_CT&#xA;&#x9;SET&#x9;&#x9;BDTS_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDTS_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;&#xA;--8&#xA;UPDATE&#x9;TB_ANOPG_OPERAZPG_CL&#xA;&#x9;SET&#x9;&#x9;anopg_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;anopg_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--9&#xA;UPDATE&#x9;BDNG_NATGIUR_CT&#xA;&#x9;SET&#x9;&#x9;BDNG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDNG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--10&#xA;UPDATE&#x9;BDSO_SOCIETA_CL&#xA;&#x9;SET&#x9;&#x9;BDSO_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDSO_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--11&#xA;UPDATE&#x9;BDSD_SEDESOC_CL&#xA;&#x9;SET&#x9;&#x9;BDSD_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDSD_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--12&#xA;UPDATE&#x9;TB_ANMPG_MAILPGIU_CL&#xA;&#x9;SET&#x9;&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANMPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--13&#xA;UPDATE&#x9;TB_ANLPG_LEGAMIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANLPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--14&#xA;--UPDATE&#x9;TB_ANCPG_COLPFGPG_CL&#xA;--&#x9;SET&#x9;&#x9;ANCPG_AUC_STATO_LAVORAZIONE = 3&#xA;--&#x9;WHERE&#x9;ANCPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--15&#xA;--UPDATE&#x9;TB_ANRDM_RUOLIDMA_CL&#xA;--&#x9;SET&#x9;&#x9;ANRDM_AUC_STATO_LAVORAZIONE = 3&#xA;--&#x9;WHERE&#x9;ANRDM_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--16&#xA;--UPDATE&#x9;BDCE_CESSATIO_CL&#xA;--&#x9;SET&#x9;&#x9;BDCE_AUC_STATO_LAVORAZIONE = 3&#xA;--&#x9;WHERE&#x9;BDCE_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--17&#xA;UPDATE&#x9;BDSV_SOCVER_CL&#xA;&#x9;SET&#x9;&#x9;BDSV_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDSV_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--18&#xA;UPDATE&#x9;TB_ANCOT_COMPTERR_CL&#xA;&#x9;SET&#x9;&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANCOT_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--19&#xA;UPDATE&#x9;TB_ANRPG_RUOLIPG_CL&#xA;&#x9;SET&#x9;&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANRPG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--20&#xA;UPDATE&#x9;TB_ANFGG_FORMAGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANFGG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--21&#xA;UPDATE&#x9;TB_ANPGO_PGOPER_CL&#xA;&#x9;SET&#x9;&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANPGO_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--22&#xA;UPDATE&#x9;TB_ANNGG_NATGIURPG_CL&#xA;&#x9;SET&#x9;&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;ANNGG_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--23&#xA;UPDATE&#x9;BDRS_STORSOC_CL&#xA;&#x9;SET&#x9;&#x9;BDRS_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDRS_AUC_STATO_LAVORAZIONE = 2&#xA;&#xA;--24&#xA;UPDATE&#x9; BDZE_ISCRIZEN_CL&#xA;&#x9;SET&#x9;&#x9;BDZE_AUC_STATO_LAVORAZIONE = 3&#xA;&#x9;WHERE&#x9;BDZE_AUC_STATO_LAVORAZIONE = 2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\SIN - PEC IPA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="99_UPDATE FINALE"
      DTS:DTSID="{9821a7f0-3522-41a1-8f8a-52295fd4e036}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="SIN - PEC IPA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="BEGIN TRY&#xA;&#x9;BEGIN TRAN;&#xA;&#xA;&#x9;-- Valorizzazione PEC IPA&#xA;&#x9;UPDATE tb_ausca_sog_contr_az&#xA;&#x9;SET ausca_pec_IPA = [ANMPG_MAIL_PERSGIU]&#xA;&#x9;FROM tb_ausca_sog_contr_az&#xA;&#x9;&#x9;INNER JOIN TB_ANMPG_MAILPGIU_CL&#xA;&#x9;&#x9;&#x9;ON tb_ausca_sog_contr_az.ausca_codice_pk = TB_ANMPG_MAILPGIU_CL.ANMPG_AUC_AUSCA_PK&#xA;&#x9;WHERE (&#xA;&#x9;&#x9;&#x9;ANMPG_AUC_AUSCA_PK IS NOT NULL&#xA;&#x9;&#x9;&#x9;AND ANMPG_AUC_AUSCA_PK &lt;&gt; 0&#xA;&#x9;&#x9;)&#xA;&#x9;AND ANMPG_FLAG_PEC = 'S'&#xA;&#x9;AND GETDATE() &gt;= ANMPG_DATA_INIZ&#xA;&#x9;AND GETDATE() &lt;= ANMPG_DATA_FINE&#xA;&#x9;AND ANMPG_ANTCO_COD_TCONTATT = '007';&#xA;&#xA;&#x9;INSERT INTO tb_aulog_log (aulog_tipo_contesto, aulog_nome_attore, aulog_data_log, aulog_descr_breve, aulog_descr_lunga, AULOG_DESCRMAX)&#xA;&#x9;VALUES ('B', 'SSIS-SIN-AUC', GETDATE(), 'SIN - PEC IPA', 'SIN - Valorizza PEC IPA su tb_ausca_sog_contr_az', 'SIN - Valorizzati ' + CAST(@@ROWCOUNT AS VARCHAR(20)) + ' record con PEC IPA su tb_ausca_sog_contr_az');&#xA;&#xA;&#x9;COMMIT;&#xA;&#xA;END TRY&#xA;BEGIN CATCH&#xA;&#x9;IF @@TRANCOUNT &gt; 0&#x9;ROLLBACK TRAN;&#xA;&#xA;&#x9;DECLARE&#x9;@Message VARCHAR(MAX);&#xA;&#x9;SELECT&#x9;@Message = ERROR_MESSAGE();&#xA;&#xA;&#x9;INSERT INTO tb_aulog_log (aulog_tipo_contesto, aulog_nome_attore, aulog_data_log, aulog_descr_breve, aulog_descr_lunga, AULOG_DESCRMAX)&#xA;&#x9;VALUES ('B', 'SSIS-SIN-AUC', GETDATE(), 'SIN - PEC IPA', SUBSTRING(@Message, 1, 200), SUBSTRING(@Message, 1, 800));&#xA;&#xA;END CATCH" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\SIN - Rappresentanti Legali"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="99_UPDATE FINALE"
      DTS:DTSID="{2673dc85-213d-4088-8840-314df5bdf2da}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="SIN - Rappresentanti Legali"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="EXEC dbo.SIN_RappresentantiLegali" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (1)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (1)"
      DTS:DTSID="{E424FC55-E663-43AD-9761-BF468D658BE8}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (1)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-01','Package AZ124_35(SIN) Inizio 2018-11-07');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (10)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (10)"
      DTS:DTSID="{6de72050-8d79-462e-84bb-48fe4d34a5de}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (10)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-10','SIN - Step 10');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (11)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (11)"
      DTS:DTSID="{4b89f6e7-cc0a-4e6b-93b5-739222155593}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (11)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-11','SIN - Step 11');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (12)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (12)"
      DTS:DTSID="{2cebcd18-3b47-40e8-b8bc-01e9a67fe9ec}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (12)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-12','SIN - Step 12');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (13)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (13)"
      DTS:DTSID="{569abd73-fd79-441e-bf9b-5fea6922cc51}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (13)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-13','SIN - Step 13');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (14)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (14)"
      DTS:DTSID="{6ab1b089-949a-40f9-a32f-f063130df111}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (14)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-14','SIN - Step 14');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (15)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (15)"
      DTS:DTSID="{beb60949-4e91-4d95-841b-917921ee2971}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (15)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-15','SIN - Step 15');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (16)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (16)"
      DTS:DTSID="{a3366137-b108-4622-bfd9-85d758478483}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (16)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-16','SIN - Step 16');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (17)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (17)"
      DTS:DTSID="{e1d60362-8b9b-4fbb-9bdc-d2229f79150d}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (17)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-17','SIN - Step 17');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (18)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (18)"
      DTS:DTSID="{2aaeb2b3-3250-4381-947f-9ba6b0031a71}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (18)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-18','SIN - Step 18');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (19)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (19)"
      DTS:DTSID="{423c5e9c-7733-4e19-9e28-7445af0b1733}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (19)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-19','SIN - Step 19');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (2)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (2)"
      DTS:DTSID="{FE367B75-A79A-4806-8EE8-8DC81ABB1217}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (2)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-02','SIN - Step 2');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (20)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (20)"
      DTS:DTSID="{a370391a-2c60-4c2c-9743-8b2ad41d4942}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (20)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-20','SIN - Step 20');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (21)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (21)"
      DTS:DTSID="{4a1e6ea6-b75b-4b83-a78f-e5a4f541cecc}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (21)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-21','SIN - Step 21');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (22)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (22)"
      DTS:DTSID="{103db0a9-34a7-4b01-9709-39a551bb6f6e}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (22)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-22','SIN - Step 22');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (23)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (23) "
      DTS:DTSID="{3c75f9de-35d5-4323-bf1a-6879157bb25d}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (23)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-23','SIN - Step 23');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (3)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (3)"
      DTS:DTSID="{18556FBE-EB5B-420F-B2A0-D2A08925E924}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (3)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-03','SIN - Step 3');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (4)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (4)"
      DTS:DTSID="{4D0FB39B-FD12-4C36-AA1A-B1277DBAF271}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (4)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-04','SIN - Step 4');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (5)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (5)"
      DTS:DTSID="{C8B93F4A-9054-41B3-8F25-55A43805C886}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (5)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-05','SIN - Step 5');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (6)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (6)"
      DTS:DTSID="{5F86515C-2FE5-4C9F-8870-16DB4F7EE8A0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (6)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-06','SIN - Step 6');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (7)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (7)"
      DTS:DTSID="{e878e183-379b-4c8e-a74c-23ee6e50a20d}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (7)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-07','SIN - Step 7');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (8)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (8)"
      DTS:DTSID="{97b4e8f3-54fa-48a2-98ab-4a704583c85e}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (8)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-08','SIN - Step 8');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (9)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (9)"
      DTS:DTSID="{9451e72b-843d-40bc-8812-b9f510697ab5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (9)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-09','SIN - Step 9');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Trace AuLOG (FINE)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Trace AuLOG (FINE)"
      DTS:DTSID="{C77E057F-B689-4712-B98B-59EE1ABCCC12}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Trace AuLOG (FINE)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{febbc687-d52e-400c-a8c0-9b5a06d1ae4e}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="INSERT INTO [tb_aulog_log] (aulog_tipo_contesto,aulog_nome_attore,aulog_data_log,aulog_descr_breve,aulog_descr_lunga)&#xA;VALUES ('B','SSIS-SIN-AUC',GETDATE(),'35-99','Package AZ124_35(SIN) Fine 2018-11-07');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{F1500550-E9EA-4E9F-97FE-1DB18B7F7FD0}"
      DTS:From="Package\Trace AuLOG (1)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\00_TI_ANTOG" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{4CC11BA3-4C75-4933-B5E3-DD0BC01198B0}"
      DTS:From="Package\Trace AuLOG (2)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\01_TI_BDRG" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{E2B050FD-41C5-46A0-B551-60258DE176E7}"
      DTS:From="Package\Trace AuLOG (6)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\05_TI_ANFGI" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{F8F68EF0-B7FC-44C3-83AA-C69FB7A513E5}"
      DTS:From="Package\05_TI_ANFGI"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\Trace AuLOG (7)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{32A93732-5D7C-44B0-BC76-57DBC68741BA}"
      DTS:From="Package\Trace AuLOG (7)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\06_TI_BDTS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 13]"
      DTS:CreationName=""
      DTS:DTSID="{20098DB0-1CB3-45E5-A330-9AB7D8C04F3B}"
      DTS:From="Package\06_TI_BDTS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 13"
      DTS:To="Package\Trace AuLOG (8)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 14]"
      DTS:CreationName=""
      DTS:DTSID="{0CD6C19C-7D00-4940-AAE2-1F8B8A35D053}"
      DTS:From="Package\Trace AuLOG (8)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 14"
      DTS:To="Package\07_TI_ANOPG" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 15]"
      DTS:CreationName=""
      DTS:DTSID="{AE55ABD7-4448-4428-8BD9-0AD2E28025FE}"
      DTS:From="Package\07_TI_ANOPG"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 15"
      DTS:To="Package\Trace AuLOG (9)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 16]"
      DTS:CreationName=""
      DTS:DTSID="{965C197B-73A3-49FD-9010-3A3FAC42DB8A}"
      DTS:From="Package\Trace AuLOG (9)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 16"
      DTS:To="Package\10_TI_BDNG" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 17]"
      DTS:CreationName=""
      DTS:DTSID="{16E2F5A7-6086-4F44-9655-DC07593D1FF1}"
      DTS:From="Package\10_TI_BDNG"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 17"
      DTS:To="Package\Trace AuLOG (10)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 18]"
      DTS:CreationName=""
      DTS:DTSID="{90C1C4E5-B21F-45DD-AF2B-2E6324CB7AAD}"
      DTS:From="Package\Trace AuLOG (10)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 18"
      DTS:To="Package\20_TI_BDSO_17 (Step 1-10)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 19]"
      DTS:CreationName=""
      DTS:DTSID="{6A01351B-1D46-454E-A646-A1D9E64C386F}"
      DTS:From="Package\20_TI_BDSO_17 (Step 1-10)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 19"
      DTS:To="Package\20_TI_BDSO_17 (Step 11-17)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{2847E935-17FC-44AA-8FB2-159DC03D99E0}"
      DTS:From="Package\Trace AuLOG (3)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\02_TB_AUCAS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 20]"
      DTS:CreationName=""
      DTS:DTSID="{1B02175B-E737-493B-AFC7-5C450659292E}"
      DTS:From="Package\Trace AuLOG (11)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 20"
      DTS:To="Package\30_TI_BDSD_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 21]"
      DTS:CreationName=""
      DTS:DTSID="{BA597C17-45D6-48C5-B6F2-2D9759B002A6}"
      DTS:From="Package\30_TI_BDSD_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 21"
      DTS:To="Package\Trace AuLOG (12)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 22]"
      DTS:CreationName=""
      DTS:DTSID="{5CFAAAAA-7A64-4ADB-B065-4DAE813E5283}"
      DTS:From="Package\Trace AuLOG (12)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 22"
      DTS:To="Package\31_TI_ANMPG_03" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 23]"
      DTS:CreationName=""
      DTS:DTSID="{374F86E3-D9F9-410C-B3BD-172DE8B889BF}"
      DTS:From="Package\31_TI_ANMPG_03"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 23"
      DTS:To="Package\Trace AuLOG (13)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 24]"
      DTS:CreationName=""
      DTS:DTSID="{C5856430-B4DD-4306-9D5A-237D52551941}"
      DTS:From="Package\Trace AuLOG (13)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 24"
      DTS:To="Package\32_TI_ANLPG_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 25]"
      DTS:CreationName=""
      DTS:DTSID="{964EEFA7-C9FB-4FFF-93D1-EC7C88D9E7D9}"
      DTS:From="Package\32_TI_ANLPG_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 25"
      DTS:To="Package\Trace AuLOG (14)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 26]"
      DTS:CreationName=""
      DTS:DTSID="{4BF3D51A-54C0-4076-BE30-C18CAD347A49}"
      DTS:From="Package\Trace AuLOG (14)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 26"
      DTS:To="Package\36_TI_BDSV_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 27]"
      DTS:CreationName=""
      DTS:DTSID="{5939397D-56D9-450D-9AB7-A226806A133E}"
      DTS:From="Package\36_TI_BDSV_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 27"
      DTS:To="Package\Trace AuLOG (15)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 28]"
      DTS:CreationName=""
      DTS:DTSID="{1560A524-17BF-44E0-B5FF-55658EB9024A}"
      DTS:From="Package\Trace AuLOG (15)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 28"
      DTS:To="Package\37_TI_ANCOT_04" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 29]"
      DTS:CreationName=""
      DTS:DTSID="{2AAD432E-14C6-4B66-B74A-E61895855EA6}"
      DTS:From="Package\37_TI_ANCOT_04"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 29"
      DTS:To="Package\Trace AuLOG (16)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{797EA45E-9BC4-4178-9625-39242462670A}"
      DTS:From="Package\Trace AuLOG (4)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\03_TI_ANTRL" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 30]"
      DTS:CreationName=""
      DTS:DTSID="{C91D7937-E2B9-4A72-8C8A-431CC70B2DFA}"
      DTS:From="Package\Trace AuLOG (16)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 30"
      DTS:To="Package\40_TI_ANRPG_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 31]"
      DTS:CreationName=""
      DTS:DTSID="{DC3A8C0E-B3B6-4B0E-983B-DB3E2E9A34C8}"
      DTS:From="Package\40_TI_ANRPG_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 31"
      DTS:To="Package\Trace AuLOG (17)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 32]"
      DTS:CreationName=""
      DTS:DTSID="{AF584E9D-59AD-4515-A68D-F32A80EF70D4}"
      DTS:From="Package\Trace AuLOG (17)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 32"
      DTS:To="Package\41_TI_ANFGG_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 33]"
      DTS:CreationName=""
      DTS:DTSID="{98F73FEA-816F-43B7-8087-DD4720579896}"
      DTS:From="Package\41_TI_ANFGG_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 33"
      DTS:To="Package\Trace AuLOG (18)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 34]"
      DTS:CreationName=""
      DTS:DTSID="{6CEC19E2-43A9-452B-A9A3-43C1BF51D07A}"
      DTS:From="Package\Trace AuLOG (18)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 34"
      DTS:To="Package\42_TI_ANPGO_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 35]"
      DTS:CreationName=""
      DTS:DTSID="{F488F2C7-F1D6-44B5-A691-58138AE4D24B}"
      DTS:From="Package\42_TI_ANPGO_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 35"
      DTS:To="Package\Trace AuLOG (19)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 36]"
      DTS:CreationName=""
      DTS:DTSID="{8C79B651-1D80-467B-B43D-76DF5EF9870E}"
      DTS:From="Package\Trace AuLOG (19)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 36"
      DTS:To="Package\43_TI_ANNGG_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 37]"
      DTS:CreationName=""
      DTS:DTSID="{57EC30F6-CF4D-4478-AE09-2DCB05741168}"
      DTS:From="Package\43_TI_ANNGG_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 37"
      DTS:To="Package\Trace AuLOG (20)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 38]"
      DTS:CreationName=""
      DTS:DTSID="{28B8E196-B133-4DF7-8D62-A7E008C4CDC3}"
      DTS:From="Package\Trace AuLOG (20)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 38"
      DTS:To="Package\44_TI_BDRS_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 39]"
      DTS:CreationName=""
      DTS:DTSID="{7C0101F6-264A-4265-A422-EFC8C9842554}"
      DTS:From="Package\44_TI_BDRS_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 39"
      DTS:To="Package\Trace AuLOG (21)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{BD143DEA-F499-4162-A229-96E58CA17411}"
      DTS:From="Package\Trace AuLOG (5)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\04_TI_ANTLP" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 40]"
      DTS:CreationName=""
      DTS:DTSID="{7AC0E0F5-C743-4381-8930-248280CEF48E}"
      DTS:From="Package\Trace AuLOG (21)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 40"
      DTS:To="Package\45_TI_BDZE_02" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 41]"
      DTS:CreationName=""
      DTS:DTSID="{5F70FB6F-9CE2-48FA-BBE7-4BF24F0EB81B}"
      DTS:From="Package\45_TI_BDZE_02"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 41"
      DTS:To="Package\Trace AuLOG (22)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 42]"
      DTS:CreationName=""
      DTS:DTSID="{3F4E0E0B-4B9D-4A5C-9A7C-5D8A8DF2D1B0}"
      DTS:From="Package\Trace AuLOG (22)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 42"
      DTS:To="Package\98_Refresh AUICA" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 43]"
      DTS:CreationName=""
      DTS:DTSID="{BA55AE00-D2FF-4538-942C-FD733044DDC5}"
      DTS:From="Package\98_Refresh AUICA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 43"
      DTS:To="Package\Trace AuLOG (23)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 44]"
      DTS:CreationName=""
      DTS:DTSID="{8DB21115-D058-44E6-BFBE-2C4D4B72AB9B}"
      DTS:From="Package\Trace AuLOG (23)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 44"
      DTS:To="Package\99_UPDATE FINALE" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{93EE8999-1FB3-4CEC-B15B-16F9F399BAD3}"
      DTS:From="Package\00_TI_ANTOG"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Trace AuLOG (2)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 50]"
      DTS:CreationName=""
      DTS:DTSID="{E79CCF0F-61F6-4FCD-ADC3-31DE61912DB8}"
      DTS:From="Package\20_TI_BDSO_17 (Step 11-17)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 50"
      DTS:To="Package\Trace AuLOG (11)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{B55E6155-0E84-4B8F-8710-B75C3D9C8AEF}"
      DTS:From="Package\01_TI_BDRG"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Trace AuLOG (3)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{C89A5612-BF4A-4931-9A79-48EF0B468307}"
      DTS:From="Package\02_TB_AUCAS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Trace AuLOG (4)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{12C3FD8C-A276-4F17-9379-19DC8A48FD5F}"
      DTS:From="Package\03_TI_ANTRL"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\Trace AuLOG (5)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{1D0C5BE1-5DF3-46B6-850C-E10958B4618B}"
      DTS:From="Package\04_TI_ANTLP"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\Trace AuLOG (6)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo]"
      DTS:CreationName=""
      DTS:DTSID="{444292F1-4053-4C35-A800-BA829B10B819}"
      DTS:From="Package\99_UPDATE FINALE"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo"
      DTS:To="Package\SIN - Rappresentanti Legali" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo 1]"
      DTS:CreationName=""
      DTS:DTSID="{E047EE09-D978-40ED-9648-E9A88A68CE15}"
      DTS:From="Package\SIN - Rappresentanti Legali"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo 1"
      DTS:To="Package\SIN - PEC IPA" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo 2]"
      DTS:CreationName=""
      DTS:DTSID="{41B82E12-D091-44F2-A23F-54FB835FCBDF}"
      DTS:From="Package\SIN - PEC IPA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo 2"
      DTS:To="Package\Trace AuLOG (FINE)" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Questa sezione CDATA contiene le informazioni sul layout del pacchetto e include informazioni quali coordinate (x,y), larghezza e altezza.-->
<!--Se si modifica manualmente la sezione e si commette un errore, è possibile eliminarla. -->
<!--Sarà comunque possibile caricare manualmente il pacchetto, ma le informazioni precedenti sul layout verranno perse e gli elementi verranno nuovamente disposti nell'area di progettazione all'interno dell'apposita finestra.-->
<Objects
  Version="sql12">
  <!--Ogni nodo seguente conterrà proprietà che non influiscono sul comportamento di runtime.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="128" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="152,42"
          Id="Package\00_TI_ANTOG"
          TopLeft="41.5,121.5" />
        <NodeLayout
          Size="145,42"
          Id="Package\01_TI_BDRG"
          TopLeft="45,325.5" />
        <NodeLayout
          Size="155,42"
          Id="Package\02_TB_AUCAS"
          TopLeft="41.5,529.5" />
        <NodeLayout
          Size="149,42"
          Id="Package\03_TI_ANTRL"
          TopLeft="43,733.5" />
        <NodeLayout
          Size="149,42"
          Id="Package\04_TI_ANTLP"
          TopLeft="43.5,937.5" />
        <NodeLayout
          Size="147,42"
          Id="Package\05_TI_ANFGI"
          TopLeft="43.5,1140.5" />
        <NodeLayout
          Size="142,42"
          Id="Package\06_TI_BDTS"
          TopLeft="46,1344.5" />
        <NodeLayout
          Size="153,42"
          Id="Package\07_TI_ANOPG"
          TopLeft="41.5,1548.5" />
        <NodeLayout
          Size="145,42"
          Id="Package\10_TI_BDNG"
          TopLeft="45,1752.5" />
        <NodeLayout
          Size="220,42"
          Id="Package\20_TI_BDSO_17 (Step 1-10)"
          TopLeft="8,1956.5" />
        <NodeLayout
          Size="227,42"
          Id="Package\20_TI_BDSO_17 (Step 11-17)"
          TopLeft="4.5,2059.5" />
        <NodeLayout
          Size="162,42"
          Id="Package\30_TI_BDSD_02"
          TopLeft="36.5,2263.5" />
        <NodeLayout
          Size="172,42"
          Id="Package\31_TI_ANMPG_03"
          TopLeft="32.5,2467.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\32_TI_ANLPG_02"
          TopLeft="34,2671.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\36_TI_BDSV_02"
          TopLeft="37,2875.5" />
        <NodeLayout
          Size="170,42"
          Id="Package\37_TI_ANCOT_04"
          TopLeft="33,3079.5" />
        <NodeLayout
          Size="171,42"
          Id="Package\40_TI_ANRPG_02"
          TopLeft="33.5,3285.5" />
        <NodeLayout
          Size="171,42"
          Id="Package\41_TI_ANFGG_02"
          TopLeft="33.5,3487.5" />
        <NodeLayout
          Size="171,42"
          Id="Package\42_TI_ANPGO_02"
          TopLeft="33,3691.5" />
        <NodeLayout
          Size="172,42"
          Id="Package\43_TI_ANNGG_02"
          TopLeft="32.500000000001,3895.5" />
        <NodeLayout
          Size="162,42"
          Id="Package\44_TI_BDRS_02"
          TopLeft="37.000000000001,4099.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\45_TI_BDZE_02"
          TopLeft="37.500000000001,4303.5" />
        <NodeLayout
          Size="172,42"
          Id="Package\98_Refresh AUICA"
          TopLeft="40.500000000001,4487.5" />
        <NodeLayout
          Size="183,42"
          Id="Package\99_UPDATE FINALE"
          TopLeft="34.500000000001,4658.5" />
        <NodeLayout
          Size="144,42"
          Id="Package\SIN - PEC IPA"
          TopLeft="52,4829" />
        <NodeLayout
          Size="208,42"
          Id="Package\SIN - Rappresentanti Legali"
          TopLeft="27,4742" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (1)"
          TopLeft="36,19.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (10)"
          TopLeft="33,1854.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (11)"
          TopLeft="33,2161.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (12)"
          TopLeft="33,2365.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (13)"
          TopLeft="33,2569.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (14)"
          TopLeft="33,2773.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (15)"
          TopLeft="33,2977.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (16)"
          TopLeft="33,3183.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (17)"
          TopLeft="33,3385.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (18)"
          TopLeft="33,3589.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (19)"
          TopLeft="33.000000000001,3793.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (2)"
          TopLeft="36,223.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (20)"
          TopLeft="33.000000000001,3998.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (21)"
          TopLeft="33.000000000001,4201.5" />
        <NodeLayout
          Size="169,42"
          Id="Package\Trace AuLOG (22)"
          TopLeft="33.000000000001,4405.5" />
        <NodeLayout
          Size="178,42"
          Id="Package\Trace AuLOG (23)"
          TopLeft="37.500000000001,4570.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (3)"
          TopLeft="36,426.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (4)"
          TopLeft="36,631.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (5)"
          TopLeft="36,835.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (6)"
          TopLeft="36,1039.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (7)"
          TopLeft="36,1242.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (8)"
          TopLeft="36,1446.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Trace AuLOG (9)"
          TopLeft="36,1650.5" />
        <NodeLayout
          Size="182,42"
          Id="Package\Trace AuLOG (FINE)"
          TopLeft="36.500000000001,4902.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="117.5,61.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="117.5,265.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="117.25,1081.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,59"
              Start="0,0"
              End="0,51.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,51.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="117.25,1182.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="117.25,1284.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 13]"
          TopLeft="117.25,1386.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 14]"
          TopLeft="117.75,1488.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 15]"
          TopLeft="117.75,1590.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 16]"
          TopLeft="117.5,1692.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 17]"
          TopLeft="117.5,1794.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 18]"
          TopLeft="117.75,1896.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 19]"
          TopLeft="118,1998.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,61"
              Start="0,0"
              End="0,53.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,53.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="118.25,468.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,61"
              Start="0,0"
              End="0,53.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,53.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 20]"
          TopLeft="117.5,2203.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 21]"
          TopLeft="117.5,2305.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 22]"
          TopLeft="118,2407.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 23]"
          TopLeft="118,2509.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 24]"
          TopLeft="118,2611.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 25]"
          TopLeft="118,2713.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 26]"
          TopLeft="117.5,2815.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 27]"
          TopLeft="117.5,2917.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 28]"
          TopLeft="117.75,3019.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 29]"
          TopLeft="117.75,3121.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,62"
              Start="0,0"
              End="0,54.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,54.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="117.5,673.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 30]"
          TopLeft="118.25,3225.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 31]"
          TopLeft="118.25,3327.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 32]"
          TopLeft="118.25,3427.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 33]"
          TopLeft="118.25,3529.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 34]"
          TopLeft="118,3631.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 35]"
          TopLeft="118,3733.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 36]"
          TopLeft="118.000000000001,3835.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 37]"
          TopLeft="118.000000000001,3937.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,61"
              Start="0,0"
              End="0,53.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,53.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 38]"
          TopLeft="117.750000000001,4040.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,59"
              Start="0,0"
              End="0,51.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,51.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 39]"
          TopLeft="117.750000000001,4141.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="117.75,877.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 40]"
          TopLeft="117.750000000001,4243.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 41]"
          TopLeft="117.750000000001,4345.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 42]"
          TopLeft="117.500000000001,4447.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.99999999999966,40"
              Start="0,0"
              End="8.99999999999966,32.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16"
                    Point2="0,20"
                    Point3="4,20" />
                  <mssgle:LineSegment
                    End="4.99999999999966,20" />
                  <mssgle:CubicBezierSegment
                    Point1="4.99999999999966,20"
                    Point2="8.99999999999966,20"
                    Point3="8.99999999999966,24" />
                  <mssgle:LineSegment
                    End="8.99999999999966,32.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 43]"
          TopLeft="126.500000000001,4529.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,41"
              Start="0,0"
              End="0,33.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 44]"
          TopLeft="126.250000000001,4612.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,46"
              Start="0,0"
              End="0,38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="117.5,163.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 50]"
          TopLeft="117.75,2101.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="117.5,367.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,59"
              Start="0,0"
              End="0,51.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,51.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="118.25,571.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="117.5,775.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="117.75,979.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo]"
          TopLeft="128.500000000001,4700.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,41.5"
              Start="0,0"
              End="0,34">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo 1]"
          TopLeft="127.5,4784">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45"
              Start="0,0"
              End="0,37.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,37.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo 2]"
          TopLeft="125.75,4871">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31.5"
              Start="0,0"
              End="0,24">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>